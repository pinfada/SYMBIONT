(()=>{"use strict";var t,e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},o={};e.r(o),e.d(o,{default:()=>a}),function(t){t[t.TRACE=0]="TRACE",t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.FATAL=5]="FATAL"}(t||(t={}));class n{constructor(e={}){this.logEntries=[],this.config={level:t.INFO,enableConsole:!this.isProduction(),enableStorage:!0,maxStorageEntries:1e3,sensitiveFields:["password","token","key","secret","auth"],productionMode:this.isProduction(),...e}}static getInstance(t){return n.instance||(n.instance=new n(t)),n.instance}isProduction(){return!0}sanitizeData(t){if("string"==typeof t)return this.sanitizeString(t);if("object"==typeof t&&null!==t){if(Array.isArray(t))return t.map((t=>this.sanitizeData(t)));const e={};for(const[o,n]of Object.entries(t))this.isSensitiveField(o)?e[o]="[REDACTED]":e[o]=this.sanitizeData(n);return e}return t}sanitizeString(t){let e=t;for(const t of n.SENSITIVE_PATTERNS)e=e.replace(t,"[REDACTED]");return e}isSensitiveField(t){return this.config.sensitiveFields.some((e=>t.toLowerCase().includes(e.toLowerCase())))}formatMessage(e,o,n,r){return`[${(new Date).toISOString()}] ${t[e]}${r?` [${r}]`:""}: ${o}${n?` ${JSON.stringify(n,null,2)}`:""}`}shouldLog(t){return t>=this.config.level}log(e,o,n,r){if(!this.shouldLog(e))return;const s=n?this.sanitizeData(n):void 0,i=this.sanitizeString(o),a={timestamp:Date.now(),level:e,message:i,data:s,context:r,sanitized:!0};if(this.config.enableStorage&&(this.logEntries.push(a),this.logEntries.length>this.config.maxStorageEntries&&(this.logEntries=this.logEntries.slice(-this.config.maxStorageEntries))),this.config.enableConsole){const o=this.formatMessage(e,i,s,r);switch(e){case t.TRACE:case t.DEBUG:console.debug(o);break;case t.INFO:console.info(o);break;case t.WARN:console.warn(o);break;case t.ERROR:case t.FATAL:console.error(o)}}}trace(e,o,n){this.log(t.TRACE,e,o,n)}debug(e,o,n){this.log(t.DEBUG,e,o,n)}info(e,o,n){this.log(t.INFO,e,o,n)}warn(e,o,n){this.log(t.WARN,e,o,n)}error(e,o,n){this.log(t.ERROR,e,o,n)}fatal(e,o,n){this.log(t.FATAL,e,o,n)}setLevel(t){this.config.level=t}enableConsole(t){this.config.enableConsole=t}getLogs(t){return void 0!==t?this.logEntries.filter((e=>e.level>=t)):[...this.logEntries]}clearLogs(){this.logEntries=[]}exportLogs(){return JSON.stringify(this.logEntries,null,2)}}n.SENSITIVE_PATTERNS=[/password/i,/token/i,/key/i,/secret/i,/auth/i,/credential/i,/session/i,/cookie/i,/jwt/i,/bearer/i,/api[_-]?key/i,/access[_-]?token/i,/refresh[_-]?token/i,/private[_-]?key/i,/\b[A-Za-z0-9+/]{32,}={0,2}\b/,/\b[0-9a-f]{32,}\b/i,/\b[0-9]{4}[_-]?[0-9]{4}[_-]?[0-9]{4}[_-]?[0-9]{4}\b/,/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/];const r=n.getInstance();r.info.bind(r),r.warn.bind(r),r.error.bind(r),r.debug.bind(r);class s{static random(){if("undefined"!=typeof crypto&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]/(this.MAX_UINT32+1)}return n.warn("SecureRandom: crypto.getRandomValues non disponible, utilisation de Math.random()"),Math.random()}static randomInt(t,e){if(t>=e)throw new Error("SecureRandom: min doit être inférieur à max");const o=e-t;return Math.floor(this.random()*o)+t}static randomFloat(t,e){if(t>=e)throw new Error("SecureRandom: min doit être inférieur à max");return this.random()*(e-t)+t}static randomBytes(t){if("undefined"!=typeof crypto&&crypto.getRandomValues){const e=new Uint8Array(t);return crypto.getRandomValues(e),e}n.warn("SecureRandom: crypto.getRandomValues non disponible, génération fallback");const e=new Uint8Array(t);for(let o=0;o<t;o++)e[o]=Math.floor(256*Math.random());return e}static choice(t){if(0===t.length)throw new Error("SecureRandom: Le tableau ne peut pas être vide");return t[this.randomInt(0,t.length)]}static uuid(){if("undefined"!=typeof crypto&&crypto.getRandomValues){const t=new Uint8Array(16);crypto.getRandomValues(t),t[6]=15&t[6]|64,t[8]=63&t[8]|128;const e=Array.from(t,(t=>t.toString(16).padStart(2,"0"))).join("");return[e.slice(0,8),e.slice(8,12),e.slice(12,16),e.slice(16,20),e.slice(20,32)].join("-")}return n.warn("SecureRandom: crypto.getRandomValues non disponible, UUID fallback"),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}static randomString(t,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"){let o="";for(let n=0;n<t;n++)o+=e.charAt(this.randomInt(0,e.length));return o}static randomId(t="",e=8){const o=this.randomString(e,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789");return t?`${t}_${o}`:o}}s.MAX_UINT32=4294967295,s.random,s.randomInt,s.randomFloat;const i=new class{constructor(){this.networks=new Map}initializeNetwork(t,e,o){const n=new Map,r=new Map,s=new Map;e.forEach((t=>{n.set(t.id,{...t}),s.set(t.id,0)})),o.forEach((t=>{r.has(t.from)||r.set(t.from,[]),r.get(t.from).push({...t})})),this.networks.set(t,{nodes:n,connections:r,activations:s})}propagateNetwork(t,e){const o=this.networks.get(t);if(!o)throw new Error(`Network ${t} not found`);Object.entries(e).forEach((([t,e])=>{o.nodes.has(t)&&o.activations.set(t,e)}));for(const[t,e]of o.nodes)"input"!==e.type&&o.activations.set(t,e.bias);for(const[t,e]of o.connections){const n=o.activations.get(t)||0;for(const t of e){if(!t.active)continue;const e=(o.activations.get(t.to)||0)+n*t.weight;o.activations.set(t.to,this.sigmoid(e))}}return Object.fromEntries(o.activations)}mutateNetwork(t,e){const o=this.networks.get(t);if(!o)throw new Error(`Network ${t} not found`);let n=!1;for(const t of o.connections.values())for(const o of t)s.random()<e&&(o.weight+=.2*(s.random()-.5),o.weight=Math.max(-2,Math.min(2,o.weight)),n=!0);for(const t of o.nodes.values())s.random()<e&&(t.bias+=.1*(s.random()-.5),t.bias=Math.max(-1,Math.min(1,t.bias)),n=!0);return n}calculateNeuralActivity(t){const e=this.networks.get(t);if(!e)throw new Error(`Network ${t} not found`);let o=0,n=0;for(const t of e.activations.values())o+=Math.abs(t),n++;const r=n>0?o/n:0;let s=0,i=0;for(const t of e.connections.values())for(const e of t)e.active&&(s+=Math.abs(e.weight),i++);return{activity:r,connectionStrength:i>0?s/i:0,nodeCount:n,connectionCount:i}}sigmoid(t){return t>10?1:t<-10?0:1/(1+Math.exp(-t))}cleanupNetwork(t){return this.networks.delete(t)}getWorkerStats(){let t=0,e=0;return this.networks.forEach((o=>{t+=o.nodes.size,e+=Array.from(o.connections.values()).reduce(((t,e)=>t+e.length),0)})),{networkCount:this.networks.size,memoryUsage:64*(t+e)}}};self.onmessage=t=>{const e=performance.now(),{type:o,id:n,payload:r}=t.data;try{let t;switch(o){case"NEURAL_INIT":i.initializeNetwork(r.networkId,r.nodes,r.connections),t={success:!0};break;case"NEURAL_PROPAGATE":t=i.propagateNetwork(r.networkId,r.inputs);break;case"NEURAL_MUTATE":t=i.mutateNetwork(r.networkId,r.rate);break;case"NEURAL_ACTIVITY":t=i.calculateNeuralActivity(r.networkId);break;default:throw new Error(`Unknown message type: ${o}`)}const s={type:"NEURAL_RESULT",id:n,payload:t,processingTime:performance.now()-e};self.postMessage(s)}catch(t){const o=performance.now()-e,r={type:"NEURAL_ERROR",id:n,payload:{message:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:void 0},processingTime:o};self.postMessage(r)}};const a=i;var c=self;for(var l in o)c[l]=o[l];o.__esModule&&Object.defineProperty(c,"__esModule",{value:!0})})();
//# sourceMappingURL=neural-worker.js.map