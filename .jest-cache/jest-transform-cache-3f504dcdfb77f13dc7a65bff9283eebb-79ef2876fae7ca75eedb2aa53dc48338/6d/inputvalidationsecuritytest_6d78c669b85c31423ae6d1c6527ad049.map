{"file":"/workspaces/SYMBIONT/__tests__/security/input-validation.security.test.ts","mappings":"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","names":[],"sources":["/workspaces/SYMBIONT/__tests__/security/input-validation.security.test.ts"],"sourcesContent":["/**\n * Tests de validation des inputs utilisateur\n * Améliore la couverture de sécurité selon audit\n */\nimport { ValidationError } from '@/shared/utils/errorValidation';\n\n// Mock des validateurs d'input\nclass InputValidator {\n  static sanitizeUserInput(input: string): string {\n    return input\n      .replace(/[<>]/g, '') // XSS basic protection\n      .replace(/['\"]/g, '&quot;') // Quote escaping\n      .trim()\n      .substring(0, 1000); // Length limit\n  }\n\n  static validateEmail(email: string): boolean {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return emailRegex.test(email) && email.length <= 254;\n  }\n\n  static validateOrganismName(name: string): boolean {\n    // Alphanumeric + spaces, 3-50 chars\n    const nameRegex = /^[a-zA-Z0-9\\s]{3,50}$/;\n    return nameRegex.test(name);\n  }\n\n  static validateJSON(jsonString: string): boolean {\n    try {\n      JSON.parse(jsonString);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  static sanitizeFilePath(filePath: string): string {\n    // Remove path traversal attempts\n    return filePath\n      .replace(/\\.\\./g, '')\n      .replace(/[\\/\\\\]/g, '_')\n      .replace(/[<>:\"|?*]/g, '');\n  }\n\n  static validateMutationData(data: unknown): data is MutationData {\n    if (!data || typeof data !== 'object') return false;\n    \n    const mutation = data as any;\n    return (\n      typeof mutation.type === 'string' &&\n      typeof mutation.strength === 'number' &&\n      mutation.strength >= 0 && mutation.strength <= 1 &&\n      (!mutation.target || typeof mutation.target === 'string')\n    );\n  }\n}\n\ninterface MutationData {\n  type: string;\n  strength: number;\n  target?: string;\n}\n\ndescribe('Input Validation Security Tests', () => {\n  describe('XSS Prevention', () => {\n    it('should sanitize basic XSS attempts', () => {\n      const maliciousInputs = [\n        '<script>alert(\"xss\")</script>',\n        '<img src=\"x\" onerror=\"alert(1)\">',\n        '<svg onload=\"alert(1)\">',\n        'javascript:alert(1)',\n        '<iframe src=\"javascript:alert(1)\">',\n        '<body onload=\"alert(1)\">'\n      ];\n\n      maliciousInputs.forEach(input => {\n        const sanitized = InputValidator.sanitizeUserInput(input);\n        expect(sanitized).not.toContain('<script>');\n        expect(sanitized).not.toContain('<img');\n        expect(sanitized).not.toContain('<svg');\n        expect(sanitized).not.toContain('<iframe');\n        expect(sanitized).not.toContain('<body');\n        expect(sanitized).not.toContain('javascript:');\n        expect(sanitized).not.toContain('onerror=');\n        expect(sanitized).not.toContain('onload=');\n      });\n    });\n\n    it('should handle unicode XSS attempts', () => {\n      const unicodeXSS = [\n        '\\u003cscript\\u003ealert(1)\\u003c/script\\u003e',\n        '\\x3Cscript\\x3Ealert(1)\\x3C/script\\x3E',\n        '&lt;script&gt;alert(1)&lt;/script&gt;'\n      ];\n\n      unicodeXSS.forEach(input => {\n        const sanitized = InputValidator.sanitizeUserInput(input);\n        expect(sanitized).toBeDefined();\n        expect(sanitized.length).toBeGreaterThan(0);\n      });\n    });\n\n    it('should preserve safe content', () => {\n      const safeInputs = [\n        'Hello World',\n        'My organism name is Symbiont-1',\n        'Energy level: 85%',\n        'Mutation completed successfully'\n      ];\n\n      safeInputs.forEach(input => {\n        const sanitized = InputValidator.sanitizeUserInput(input);\n        expect(sanitized).toBe(input);\n      });\n    });\n  });\n\n  describe('NoSQL Injection Prevention', () => {\n    it('should detect NoSQL injection patterns', () => {\n      const nosqlAttacks = [\n        '{\"$ne\": \"\"}',\n        '{\"$gt\": \"\"}',\n        '{\"$regex\": \".*\"}',\n        '{\"$where\": \"function() { return true; }\"}',\n        '{\"$exists\": true}',\n        '{\"$in\": [\"admin\", \"root\"]}',\n        '{\"$or\": [{\"admin\": true}, {\"user\": \"admin\"}]}'\n      ];\n\n      nosqlAttacks.forEach(attack => {\n        const isValid = InputValidator.validateJSON(attack);\n        expect(isValid).toBe(true); // JSON is valid\n        \n        // But we should detect and reject NoSQL operators\n        const hasNoSQLOperators = /\\$\\w+/.test(attack);\n        expect(hasNoSQLOperators).toBe(true);\n        \n        // In a real validator, we would reject this\n        const isSafeQuery = !hasNoSQLOperators;\n        expect(isSafeQuery).toBe(false);\n      });\n    });\n\n    it('should validate safe query objects', () => {\n      const safeQueries = [\n        '{\"name\": \"Symbiont-1\"}',\n        '{\"energy\": 85}',\n        '{\"type\": \"neural\", \"active\": true}',\n        '{\"traits\": [\"intelligence\", \"adaptation\"]}'\n      ];\n\n      safeQueries.forEach(query => {\n        const isValid = InputValidator.validateJSON(query);\n        expect(isValid).toBe(true);\n        \n        const hasNoSQLOperators = /\\$\\w+/.test(query);\n        expect(hasNoSQLOperators).toBe(false);\n      });\n    });\n  });\n\n  describe('Path Traversal Prevention', () => {\n    it('should prevent directory traversal attacks', () => {\n      const traversalAttacks = [\n        '../../../etc/passwd',\n        '..\\\\..\\\\windows\\\\system32\\\\config\\\\sam',\n        '....//....//etc/shadow',\n        '..%2F..%2F..%2Fetc%2Fpasswd',\n        '..%5c..%5c..%5cwindows%5csystem32',\n        '/var/log/../../../etc/passwd',\n        'C:\\\\Users\\\\..\\\\..\\\\Windows\\\\System32'\n      ];\n\n      traversalAttacks.forEach(attack => {\n        const sanitized = InputValidator.sanitizeFilePath(attack);\n        expect(sanitized).not.toContain('..');\n        expect(sanitized).not.toContain('/');\n        expect(sanitized).not.toContain('\\\\');\n        expect(sanitized).not.toContain('etc');\n        expect(sanitized).not.toContain('passwd');\n        expect(sanitized).not.toContain('system32');\n      });\n    });\n\n    it('should allow safe file names', () => {\n      const safeNames = [\n        'organism_data.json',\n        'backup_20250818.txt',\n        'neural_weights_v1.dat',\n        'user_preferences.config'\n      ];\n\n      safeNames.forEach(name => {\n        const sanitized = InputValidator.sanitizeFilePath(name);\n        // Should be similar but with path separators removed\n        expect(sanitized).toBeTruthy();\n        expect(sanitized.length).toBeGreaterThan(0);\n      });\n    });\n  });\n\n  describe('Email Validation', () => {\n    it('should validate legitimate emails', () => {\n      const validEmails = [\n        'user@example.com',\n        'test.user+tag@domain.co.uk',\n        'user123@test-domain.org',\n        'simple@domain.net'\n      ];\n\n      validEmails.forEach(email => {\n        expect(InputValidator.validateEmail(email)).toBe(true);\n      });\n    });\n\n    it('should reject malicious email attempts', () => {\n      const maliciousEmails = [\n        'user@domain.com<script>alert(1)</script>',\n        'user+<img src=x onerror=alert(1)>@domain.com',\n        'javascript:alert(1)@domain.com',\n        'user@domain.com\"; DROP TABLE users; --',\n        'user@domain.com\\\\r\\\\nBCC: attacker@evil.com'\n      ];\n\n      maliciousEmails.forEach(email => {\n        expect(InputValidator.validateEmail(email)).toBe(false);\n      });\n    });\n\n    it('should handle email length limits', () => {\n      const longEmail = 'a'.repeat(250) + '@domain.com';\n      expect(InputValidator.validateEmail(longEmail)).toBe(false);\n      \n      const maxEmail = 'a'.repeat(240) + '@domain.com';\n      expect(InputValidator.validateEmail(maxEmail)).toBe(true);\n    });\n  });\n\n  describe('Organism Data Validation', () => {\n    it('should validate proper mutation data', () => {\n      const validMutations = [\n        { type: 'genetic', strength: 0.5 },\n        { type: 'behavioral', strength: 0.1, target: 'social' },\n        { type: 'neural', strength: 1.0 },\n        { type: 'adaptive', strength: 0.0, target: 'environment' }\n      ];\n\n      validMutations.forEach(mutation => {\n        expect(InputValidator.validateMutationData(mutation)).toBe(true);\n      });\n    });\n\n    it('should reject malicious mutation data', () => {\n      const maliciousMutations = [\n        { type: '<script>alert(1)</script>', strength: 0.5 },\n        { type: 'genetic', strength: -1 }, // Negative strength\n        { type: 'genetic', strength: 2 }, // Over limit\n        { type: 'genetic', strength: 'high' }, // Wrong type\n        { constructor: { prototype: {} }, type: 'genetic', strength: 0.5 },\n        { type: 'genetic', strength: 0.5, __proto__: { malicious: true } }\n      ];\n\n      maliciousMutations.forEach(mutation => {\n        expect(InputValidator.validateMutationData(mutation)).toBe(false);\n      });\n    });\n\n    it('should validate organism names', () => {\n      const validNames = [\n        'Symbiont Alpha',\n        'Neural Entity 42',\n        'Adaptive Organism',\n        'Entity123'\n      ];\n\n      const invalidNames = [\n        'A', // Too short\n        'A'.repeat(51), // Too long\n        'Entity<script>alert(1)</script>', // XSS\n        'Organism\"; DROP TABLE organisms; --', // SQL injection\n        'Entity\\r\\nMalicious\\r\\n', // CRLF injection\n        'Organism\\x00null\\x00' // Null byte injection\n      ];\n\n      validNames.forEach(name => {\n        expect(InputValidator.validateOrganismName(name)).toBe(true);\n      });\n\n      invalidNames.forEach(name => {\n        expect(InputValidator.validateOrganismName(name)).toBe(false);\n      });\n    });\n  });\n\n  describe('Buffer Overflow Prevention', () => {\n    it('should limit input lengths', () => {\n      const maxLength = 1000;\n      const oversizedInput = 'A'.repeat(maxLength + 100);\n      \n      const sanitized = InputValidator.sanitizeUserInput(oversizedInput);\n      expect(sanitized.length).toBeLessThanOrEqual(maxLength);\n    });\n\n    it('should handle empty and null inputs safely', () => {\n      const emptyInputs = ['', null, undefined];\n      \n      emptyInputs.forEach(input => {\n        const result = InputValidator.sanitizeUserInput(input as string);\n        expect(result).toBeDefined();\n        expect(typeof result).toBe('string');\n      });\n    });\n  });\n\n  describe('Regular Expression Security', () => {\n    it('should use safe regex patterns', () => {\n      const testInputs = [\n        'a'.repeat(1000),\n        'aaaaaaaaaaaaaaaaaaaaaa!',\n        'x'.repeat(10000),\n        'normal input'\n      ];\n\n      testInputs.forEach(input => {\n        const start = performance.now();\n        \n        // Test email regex performance\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        emailRegex.test(input + '@test.com');\n        \n        // Test organism name regex performance\n        const nameRegex = /^[a-zA-Z0-9\\s]{3,50}$/;\n        nameRegex.test(input);\n        \n        const duration = performance.now() - start;\n        \n        // Regex should not take more than 10ms\n        expect(duration).toBeLessThan(10);\n      });\n    });\n\n    it('should prevent ReDoS attacks', () => {\n      // Test patterns that could cause catastrophic backtracking\n      const potentialReDoSInputs = [\n        'a'.repeat(50) + 'X',\n        'abc'.repeat(100) + 'X',\n        '123'.repeat(200) + 'X'\n      ];\n\n      potentialReDoSInputs.forEach(input => {\n        const start = performance.now();\n        \n        // Safe regex that won't cause ReDoS\n        const safeRegex = /^[a-zA-Z0-9]{3,50}$/;\n        safeRegex.test(input);\n        \n        const duration = performance.now() - start;\n        expect(duration).toBeLessThan(5);\n      });\n    });\n  });\n\n  describe('Content Security Policy', () => {\n    it('should validate CSP-safe content', () => {\n      const unsafeContent = [\n        \"javascript:alert('xss')\",\n        \"data:text/html,<script>alert(1)</script>\",\n        \"vbscript:msgbox('xss')\",\n        \"about:blank#<script>alert(1)</script>\"\n      ];\n\n      unsafeContent.forEach(content => {\n        const isUnsafe = /^(javascript|data|vbscript|about):/.test(content);\n        expect(isUnsafe).toBe(true);\n        \n        // CSP should block this content\n        const sanitized = InputValidator.sanitizeUserInput(content);\n        expect(sanitized).not.toMatch(/^(javascript|data|vbscript):/);\n      });\n    });\n  });\n});"],"version":3}