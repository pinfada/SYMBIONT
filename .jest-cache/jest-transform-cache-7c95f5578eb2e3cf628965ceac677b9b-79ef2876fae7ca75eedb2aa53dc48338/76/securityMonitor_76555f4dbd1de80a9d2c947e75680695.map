{"version":3,"names":["cov_1ptj6uqfsv","actualCoverage","exports","logAccess","s","resetAttempts","fs_1","__importDefault","require","path_1","LOG_PATH","default","join","__dirname","attempts","ip","route","status","f","line","Date","toISOString","appendFileSync","b"],"sources":["/mnt/c/Users/m_oli/Projets/SYMBIONT/src/core/securityMonitor.ts"],"sourcesContent":["import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst LOG_PATH = path.join(__dirname, '../../security.log');\r\nconst attempts: Record<string, number> = {};\r\n\r\nexport function logAccess(ip: string, route: string, status: number) {\r\n  const line = `${new Date().toISOString()} | ${ip} | ${route} | ${status}\\n`;\r\n  fs.appendFileSync(LOG_PATH, line);\r\n  if (status === 403) {\r\n    attempts[ip] = (attempts[ip] || 0) + 1;\r\n    if (attempts[ip] > 5) {\r\n      // Alerte brute force\r\n      fs.appendFileSync(LOG_PATH, `ALERT: Brute force suspect√©e depuis ${ip}\\n`);\r\n    }\r\n  }\r\n}\r\n\r\nexport function resetAttempts(ip: string) {\r\n  attempts[ip] = 0;\r\n} "],"mappings":"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","ignoreList":[]}