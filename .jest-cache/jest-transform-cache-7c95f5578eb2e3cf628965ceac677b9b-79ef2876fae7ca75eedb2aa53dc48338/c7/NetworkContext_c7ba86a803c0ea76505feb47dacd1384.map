{"version":3,"names":["cov_172q5jwqsb","actualCoverage","s","exports","NetworkProvider","useNetwork","react_1","require","API_URL","process","env","NODE_ENV","b","WS_URL","NetworkContext","createContext","children","f","network","setNetwork","useState","nodes","links","loading","setLoading","error","setError","wsConnected","setWsConnected","actionStatus","setActionStatus","useEffect","fetch","then","res","json","data","catch","ws","WebSocket","onopen","onmessage","event","JSON","parse","console","onclose","close","invite","source","target","traits","method","headers","body","stringify","setTimeout","fusion","type","participants","result","jsx_runtime_1","jsx","Provider","value","useContext"],"sources":["/mnt/c/Users/m_oli/Projets/SYMBIONT/src/shared/NetworkContext.tsx"],"sourcesContent":["import { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\n\r\nconst API_URL = process.env.NODE_ENV === 'development' ? 'http://localhost:8080' : 'https://symbiont-backend.onrender.com';\r\nconst WS_URL = process.env.NODE_ENV === 'development' ? 'ws://localhost:8080' : 'wss://symbiont-backend.onrender.com';\r\n\r\ninterface Network {\r\n  nodes: any[];\r\n  links: any[];\r\n}\r\ninterface InviteParams {\r\n  source: string;\r\n  target: string;\r\n  traits: any;\r\n}\r\ninterface FusionParams {\r\n  type: string;\r\n  participants: string[];\r\n  result: string;\r\n  traits: any;\r\n}\r\n\r\ninterface NetworkContextType {\r\n  network: Network;\r\n  loading: boolean;\r\n  error: string | null;\r\n  wsConnected: boolean;\r\n  actionStatus: 'idle' | 'loading' | 'success' | 'error';\r\n  invite: (params: InviteParams) => Promise<void>;\r\n  fusion: (params: FusionParams) => Promise<void>;\r\n}\r\n\r\nconst NetworkContext = createContext<NetworkContextType | null>(null);\r\n\r\nexport function NetworkProvider({ children }: { children: ReactNode }) {\r\n  const [network, setNetwork] = useState<Network>({ nodes: [], links: [] });\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [wsConnected, setWsConnected] = useState(false);\r\n  const [actionStatus, setActionStatus] = useState<'idle'|'loading'|'success'|'error'>('idle');\r\n\r\n  // Fetch initial\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    fetch(API_URL + '/api/network')\r\n      .then(res => res.json())\r\n      .then(data => { setNetwork(data); setLoading(false); })\r\n      .catch(() => { setError('Erreur rÃ©seau'); setLoading(false); });\r\n  }, []);\r\n\r\n  // WebSocket\r\n  useEffect(() => {\r\n    const ws = new WebSocket(WS_URL);\r\n    \r\n    ws.onopen = () => {\r\n      setWsConnected(true);\r\n    };\r\n    \r\n    ws.onmessage = (event) => {\r\n      try {\r\n        const data = JSON.parse(event.data);\r\n        setNetwork(data);\r\n      } catch (error) {\r\n        console.error('Failed to parse network data:', error);\r\n      }\r\n    };\r\n    \r\n    ws.onclose = () => {\r\n      setWsConnected(false);\r\n    };\r\n    \r\n    return () => {\r\n      ws.close();\r\n    };\r\n  }, []);\r\n\r\n  // Actions\r\n  async function invite({ source, target, traits }: InviteParams) {\r\n    setActionStatus('loading');\r\n    try {\r\n      await fetch(API_URL + '/api/invite', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ source, target, traits })\r\n      });\r\n      setActionStatus('success');\r\n      setTimeout(() => setActionStatus('idle'), 2000);\r\n    } catch {\r\n      setActionStatus('error');\r\n    }\r\n  }\r\n  async function fusion({ type, participants, result, traits }: FusionParams) {\r\n    setActionStatus('loading');\r\n    try {\r\n      await fetch(API_URL + '/api/ritual', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ type, participants, result, traits })\r\n      });\r\n      setActionStatus('success');\r\n      setTimeout(() => setActionStatus('idle'), 2000);\r\n    } catch {\r\n      setActionStatus('error');\r\n    }\r\n  }\r\n\r\n  return (\r\n    <NetworkContext.Provider value={{\r\n      network, loading, error, wsConnected, actionStatus,\r\n      invite, fusion\r\n    }}>\r\n      {children}\r\n    </NetworkContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useNetwork() {\r\n  return useContext(NetworkContext)!;\r\n} "],"mappings":"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","ignoreList":[]}