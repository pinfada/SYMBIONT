{"version":3,"names":["MessageBus_1","cov_1rrnu3a8n6","s","require","WebGLMessageAdapter","constructor","engine","messageBus","f","setupListeners","on","MessageType","ORGANISM_MUTATE","message","mutation","payload","mutate","err","console","error","ORGANISM_STATE_CHANGE","state","render","setInterval","metrics","getPerformanceMetrics","send","type","PERFORMANCE_UPDATE","exports"],"sources":["/mnt/c/Users/m_oli/Projets/SYMBIONT/src/integration/WebGLMessageAdapter.ts"],"sourcesContent":["// src/integration/WebGLMessageAdapter.ts\r\nimport { OrganismEngine } from '../generative/OrganismEngine';\r\nimport { OrganismState, OrganismMutation } from '../shared/types/organism';\r\n\r\n// MessageBus et MessageType doivent être importés selon votre architecture\r\nimport { MessageBus, MessageType } from '../shared/messaging/MessageBus';\r\n\r\n/**\r\n * Adaptateur entre le bus de messages et le moteur WebGL\r\n */\r\nexport class WebGLMessageAdapter {\r\n    private engine: OrganismEngine;\r\n    private messageBus: MessageBus;\r\n    \r\n    constructor(engine: OrganismEngine, messageBus: MessageBus) {\r\n      this.engine = engine;\r\n      this.messageBus = messageBus;\r\n      this.setupListeners();\r\n    }\r\n    \r\n  /**\r\n   * Mise en place des listeners sur le bus de messages\r\n   */\r\n    private setupListeners(): void {\r\n      // Écoute des mutations\r\n    this.messageBus.on(MessageType.ORGANISM_MUTATE, (message: any) => {\r\n      try {\r\n        const { mutation } = message.payload;\r\n        this.engine.mutate(mutation as OrganismMutation);\r\n      } catch (err) {\r\n        console.error('Erreur lors de l’application de la mutation WebGL :', err);\r\n      }\r\n      });\r\n      \r\n      // Écoute des changements d'état\r\n    this.messageBus.on(MessageType.ORGANISM_STATE_CHANGE, (message: any) => {\r\n      try {\r\n        const { state } = message.payload;\r\n        this.engine.render(state as OrganismState);\r\n      } catch (err) {\r\n        console.error('Erreur lors du rendu WebGL :', err);\r\n      }\r\n      });\r\n      \r\n      // Notification de performance\r\n      setInterval(() => {\r\n      try {\r\n        const metrics = this.engine.getPerformanceMetrics();\r\n        this.messageBus.send({\r\n          type: MessageType.PERFORMANCE_UPDATE,\r\n          payload: metrics\r\n        });\r\n      } catch (err) {\r\n        // On ignore les erreurs de métriques pour ne pas polluer la console\r\n      }\r\n      }, 1000);\r\n    }\r\n}"],"mappings":"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","ignoreList":[]}