64a1df87ff087d3e8d9b8e6190861218
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Mock swCryptoAPI for SecurityManager
jest.mock('../src/background/service-worker-adapter', () => ({
    swCryptoAPI: {
        subtle: cryptoSubtle,
        getRandomValues: cryptoGetRandomValues
    }
}));
// Jest setup file for SYMBIONT tests
require("@testing-library/jest-dom");
// Mock global objects that might not be available in test environment
global.performance = global.performance || {};
global.performance.now = jest.fn(() => Date.now());
global.performance.mark = jest.fn();
global.performance.measure = jest.fn();
global.performance.clearMarks = jest.fn();
global.performance.clearMeasures = jest.fn();
global.performance.getEntries = jest.fn(() => []);
global.performance.getEntriesByName = jest.fn(() => []);
global.performance.getEntriesByType = jest.fn(() => []);
// Mock PerformanceObserver
global.PerformanceObserver = jest.fn().mockImplementation((callback) => ({
    observe: jest.fn(),
    disconnect: jest.fn(),
    takeRecords: jest.fn(() => [])
}));
// Mock TextEncoder/TextDecoder for Node.js
const { TextEncoder, TextDecoder } = require('util');
global.TextEncoder = TextEncoder;
global.TextDecoder = TextDecoder;
// Mock btoa/atob for Node.js
global.btoa = global.btoa || ((str) => Buffer.from(str, 'binary').toString('base64'));
global.atob = global.atob || ((str) => Buffer.from(str, 'base64').toString('binary'));
// Mock crypto for WebCrypto
const mockCryptoKey = {
    type: 'secret',
    extractable: true,
    algorithm: { name: 'AES-GCM', length: 256 },
    usages: ['encrypt', 'decrypt']
};
// Create realistic mock data
const createMockEncryptionResult = (plaintext) => {
    const encoder = new TextEncoder();
    const data = encoder.encode(plaintext);
    const iv = new Uint8Array(12);
    const mockEncrypted = new Uint8Array(data.length + 16); // +16 for auth tag
    data.forEach((byte, i) => {
        mockEncrypted[i] = byte ^ 0xAA; // Simple XOR for mock encryption
    });
    return mockEncrypted.buffer;
};
const createMockDecryptionResult = (encryptedData) => {
    const data = new Uint8Array(encryptedData);
    const decrypted = new Uint8Array(data.length - 16); // -16 for auth tag
    for (let i = 0; i < decrypted.length; i++) {
        decrypted[i] = data[i] ^ 0xAA; // Reverse XOR
    }
    return decrypted.buffer;
};
// Enhanced crypto mock
const cryptoSubtle = {
    generateKey: jest.fn().mockResolvedValue(mockCryptoKey),
    importKey: jest.fn().mockResolvedValue(mockCryptoKey),
    exportKey: jest.fn().mockResolvedValue(new ArrayBuffer(32)),
    encrypt: jest.fn().mockImplementation(async (algorithm, key, data) => {
        const decoder = new TextDecoder();
        const plaintext = decoder.decode(data);
        return createMockEncryptionResult(plaintext);
    }),
    decrypt: jest.fn().mockImplementation(async (algorithm, key, data) => {
        return createMockDecryptionResult(data);
    }),
    digest: jest.fn().mockImplementation(async (algorithm, data) => {
        // Mock SHA-256 hash - create realistic output
        const input = data instanceof ArrayBuffer ? new Uint8Array(data) : data;
        const hash = new Uint8Array(32);
        for (let i = 0; i < 32; i++) {
            hash[i] = (input[i % input.length] + i) % 256;
        }
        return hash.buffer;
    })
};
const cryptoGetRandomValues = jest.fn((arr) => {
    for (let i = 0; i < arr.length; i++) {
        arr[i] = Math.floor(Math.random() * 256);
    }
    return arr;
});
global.crypto = global.crypto || {};
global.crypto.subtle = cryptoSubtle;
global.crypto.getRandomValues = cryptoGetRandomValues;
// Mock requestAnimationFrame and cancelAnimationFrame
global.requestAnimationFrame = jest.fn((callback) => {
    return setTimeout(callback, 16); // ~60fps
});
global.cancelAnimationFrame = jest.fn((id) => {
    clearTimeout(id);
});
// Mock URL.createObjectURL for Web Workers
global.URL = global.URL || {};
global.URL.createObjectURL = jest.fn(() => 'blob:mock-url');
global.URL.revokeObjectURL = jest.fn();
// Mock Worker constructor
global.Worker = jest.fn().mockImplementation(() => ({
    postMessage: jest.fn(),
    terminate: jest.fn(),
    addEventListener: jest.fn(),
    removeEventListener: jest.fn(),
    onmessage: null,
    onerror: null
}));
// Mock WebGL context
const createMockWebGLContext = () => ({
    // WebGL constants
    TRIANGLES: 4,
    LINES: 1,
    POINTS: 0,
    ARRAY_BUFFER: 34962,
    ELEMENT_ARRAY_BUFFER: 34963,
    DYNAMIC_DRAW: 35048,
    STATIC_DRAW: 35044,
    FLOAT: 5126,
    UNSIGNED_SHORT: 5123,
    // Buffer methods
    createBuffer: jest.fn(() => ({ id: Math.random() })),
    deleteBuffer: jest.fn(),
    bindBuffer: jest.fn(),
    bufferData: jest.fn(),
    // Vertex attributes
    vertexAttribPointer: jest.fn(),
    enableVertexAttribArray: jest.fn(),
    disableVertexAttribArray: jest.fn(),
    // Drawing
    drawArrays: jest.fn(),
    drawElements: jest.fn(),
    // Shaders (for future tests)
    createShader: jest.fn(() => ({ id: Math.random() })),
    createProgram: jest.fn(() => ({ id: Math.random() })),
    compileShader: jest.fn(),
    linkProgram: jest.fn(),
    useProgram: jest.fn(),
    // State
    viewport: jest.fn(),
    clear: jest.fn(),
    clearColor: jest.fn(),
    enable: jest.fn(),
    disable: jest.fn(),
    // Error checking
    getError: jest.fn(() => 0), // GL_NO_ERROR
    // Extensions
    getExtension: jest.fn(),
    getSupportedExtensions: jest.fn(() => [])
});
// Mock canvas and WebGL
HTMLCanvasElement.prototype.getContext = jest.fn((contextType) => {
    if (contextType === 'webgl' || contextType === 'experimental-webgl') {
        return createMockWebGLContext();
    }
    if (contextType === 'webgl2') {
        return {
            ...createMockWebGLContext(),
            createVertexArray: jest.fn(() => ({ id: Math.random() })),
            deleteVertexArray: jest.fn(),
            bindVertexArray: jest.fn()
        };
    }
    return null;
});
// Mock Chrome APIs for extension testing
const mockStorageData = {};
global.chrome = {
    runtime: {
        onMessage: {
            addListener: jest.fn(),
            removeListener: jest.fn()
        },
        sendMessage: jest.fn(),
        getURL: jest.fn((path) => `chrome-extension://mock-id/${path}`)
    },
    tabs: {
        query: jest.fn(),
        create: jest.fn(),
        update: jest.fn()
    },
    storage: {
        local: {
            get: jest.fn().mockImplementation((keys, callback) => {
                const result = {};
                if (typeof keys === 'string') {
                    if (mockStorageData[keys] !== undefined) {
                        result[keys] = mockStorageData[keys];
                    }
                }
                else if (Array.isArray(keys)) {
                    keys.forEach(key => {
                        if (mockStorageData[key] !== undefined) {
                            result[key] = mockStorageData[key];
                        }
                    });
                }
                else {
                    Object.assign(result, mockStorageData);
                }
                if (callback)
                    callback(result);
                return Promise.resolve(result);
            }),
            set: jest.fn().mockImplementation((items, callback) => {
                Object.assign(mockStorageData, items);
                if (callback)
                    callback();
                return Promise.resolve();
            }),
            remove: jest.fn().mockImplementation((keys, callback) => {
                const keysArray = Array.isArray(keys) ? keys : [keys];
                keysArray.forEach(key => delete mockStorageData[key]);
                if (callback)
                    callback();
                return Promise.resolve();
            }),
            clear: jest.fn().mockImplementation((callback) => {
                Object.keys(mockStorageData).forEach(key => delete mockStorageData[key]);
                if (callback)
                    callback();
                return Promise.resolve();
            })
        },
        sync: {
            get: jest.fn().mockResolvedValue({}),
            set: jest.fn().mockResolvedValue(undefined),
            remove: jest.fn().mockResolvedValue(undefined),
            clear: jest.fn().mockResolvedValue(undefined)
        }
    }
};
// Console override for test cleanup
const originalConsole = global.console;
global.console = {
    ...originalConsole,
    // Suppress console.log in tests unless explicitly needed
    log: process.env.JEST_VERBOSE === 'true' ? originalConsole.log : jest.fn(),
    info: process.env.JEST_VERBOSE === 'true' ? originalConsole.info : jest.fn(),
    warn: originalConsole.warn,
    error: originalConsole.error,
    debug: process.env.JEST_VERBOSE === 'true' ? originalConsole.debug : jest.fn()
};
// Increase timeout for integration tests
jest.setTimeout(10000);
// Global test utilities
global.testUtils = {
    // Helper to wait for async operations
    waitFor: (ms) => new Promise(resolve => setTimeout(resolve, ms)),
    // Helper to create mock DNA sequences
    createMockDNA: (length = 16) => {
        const bases = ['A', 'T', 'C', 'G'];
        return Array.from({ length }, () => bases[Math.floor(Math.random() * bases.length)]).join('');
    },
    // Helper to create valid organism traits
    createMockTraits: () => ({
        curiosity: Math.random(),
        focus: Math.random(),
        rhythm: Math.random(),
        empathy: Math.random(),
        creativity: Math.random(),
        resilience: Math.random(),
        adaptability: Math.random(),
        memory: Math.random(),
        intuition: Math.random() * 0.2 // Intuition is typically lower
    }),
    // Helper to suppress console output during tests
    suppressConsole: () => {
        const spy = {
            log: jest.spyOn(console, 'log').mockImplementation(() => { }),
            info: jest.spyOn(console, 'info').mockImplementation(() => { }),
            warn: jest.spyOn(console, 'warn').mockImplementation(() => { }),
            error: jest.spyOn(console, 'error').mockImplementation(() => { }),
            debug: jest.spyOn(console, 'debug').mockImplementation(() => { })
        };
        return () => {
            Object.values(spy).forEach(s => s.mockRestore());
        };
    }
};
// Clean up after each test
afterEach(() => {
    jest.clearAllMocks();
    jest.clearAllTimers();
    // Clear mock storage data
    Object.keys(mockStorageData).forEach(key => delete mockStorageData[key]);
    // Reset performance mock if it exists and is a Jest mock
    if (global.performance.now && typeof global.performance.now.mockClear === 'function') {
        global.performance.now.mockClear();
    }
    // Reset RAF mocks if they exist and are Jest mocks
    if (global.requestAnimationFrame && typeof global.requestAnimationFrame.mockClear === 'function') {
        global.requestAnimationFrame.mockClear();
    }
    if (global.cancelAnimationFrame && typeof global.cancelAnimationFrame.mockClear === 'function') {
        global.cancelAnimationFrame.mockClear();
    }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL21udC9jL1VzZXJzL21fb2xpL1Byb2pldHMvU1lNQklPTlQvX190ZXN0c19fL3NldHVwLnRzIiwibWFwcGluZ3MiOiI7O0FBOEZBLHVDQUF1QztBQUN2QyxJQUFJLENBQUMsSUFBSSxDQUFDLDBDQUEwQyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDM0QsV0FBVyxFQUFFO1FBQ1gsTUFBTSxFQUFFLFlBQVk7UUFDcEIsZUFBZSxFQUFFLHFCQUFxQjtLQUN2QztDQUNGLENBQUMsQ0FBQyxDQUFDO0FBcEdKLHFDQUFxQztBQUNyQyxxQ0FBbUM7QUFFbkMsc0VBQXNFO0FBQ3RFLE1BQU0sQ0FBQyxXQUFXLEdBQUcsTUFBTSxDQUFDLFdBQVcsSUFBSSxFQUFFLENBQUM7QUFDOUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztBQUNuRCxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7QUFDcEMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO0FBQ3ZDLE1BQU0sQ0FBQyxXQUFXLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztBQUMxQyxNQUFNLENBQUMsV0FBVyxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7QUFDN0MsTUFBTSxDQUFDLFdBQVcsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNsRCxNQUFNLENBQUMsV0FBVyxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7QUFDeEQsTUFBTSxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsRUFB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QU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLE9BQU8sZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFFekUseURBQXlEO0lBQ3pELElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFHLElBQUksT0FBUSxNQUFNLENBQUMsV0FBVyxDQUFDLEdBQVcsQ0FBQyxTQUFTLEtBQUssVUFBVSxFQUFFLENBQUM7UUFDN0YsTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFpQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQ3BELENBQUM7SUFFRCxtREFBbUQ7SUFDbkQsSUFBSSxNQUFNLENBQUMscUJBQXFCLElBQUksT0FBUSxNQUFNLENBQUMscUJBQTZCLENBQUMsU0FBUyxLQUFLLFVBQVUsRUFBRSxDQUFDO1FBQ3pHLE1BQU0sQ0FBQyxxQkFBbUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUMxRCxDQUFDO0lBQ0QsSUFBSSxNQUFNLENBQUMsb0JBQW9CLElBQUksT0FBUSxNQUFNLENBQUMsb0JBQTRCLENBQUMsU0FBUyxLQUFLLFVBQVUsRUFBRSxDQUFDO1FBQ3ZHLE1BQU0sQ0FBQyxvQkFBa0MsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUN6RCxDQUFDO0FBQ0gsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL21udC9jL1VzZXJzL21fb2xpL1Byb2pldHMvU1lNQklPTlQvX190ZXN0c19fL3NldHVwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEplc3Qgc2V0dXAgZmlsZSBmb3IgU1lNQklPTlQgdGVzdHNcclxuaW1wb3J0ICdAdGVzdGluZy1saWJyYXJ5L2plc3QtZG9tJztcclxuXHJcbi8vIE1vY2sgZ2xvYmFsIG9iamVjdHMgdGhhdCBtaWdodCBub3QgYmUgYXZhaWxhYmxlIGluIHRlc3QgZW52aXJvbm1lbnRcclxuZ2xvYmFsLnBlcmZvcm1hbmNlID0gZ2xvYmFsLnBlcmZvcm1hbmNlIHx8IHt9O1xyXG5nbG9iYWwucGVyZm9ybWFuY2Uubm93ID0gamVzdC5mbigoKSA9PiBEYXRlLm5vdygpKTtcclxuZ2xvYmFsLnBlcmZvcm1hbmNlLm1hcmsgPSBqZXN0LmZuKCk7XHJcbmdsb2JhbC5wZXJmb3JtYW5jZS5tZWFzdXJlID0gamVzdC5mbigpO1xyXG5nbG9iYWwucGVyZm9ybWFuY2UuY2xlYXJNYXJrcyA9IGplc3QuZm4oKTtcclxuZ2xvYmFsLnBlcmZvcm1hbmNlLmNsZWFyTWVhc3VyZXMgPSBqZXN0LmZuKCk7XHJcbmdsb2JhbC5wZXJmb3JtYW5jZS5nZXRFbnRyaWVzID0gamVzdC5mbigoKSA9PiBbXSk7XHJcbmdsb2JhbC5wZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlOYW1lID0gamVzdC5mbigoKSA9PiBbXSk7XHJcbmdsb2JhbC5wZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlID0gamVzdC5mbigoKSA9PiBbXSk7XHJcblxyXG4vLyBNb2NrIFBlcmZvcm1hbmNlT2JzZXJ2ZXJcclxuZ2xvYmFsLlBlcmZvcm1hbmNlT2JzZXJ2ZXIgPSBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKChjYWxsYmFjaykgPT4gKHtcclxuICBvYnNlcnZlOiBqZXN0LmZuKCksXHJcbiAgZGlzY29ubmVjdDogamVzdC5mbigpLFxyXG4gIHRha2VSZWNvcmRzOiBqZXN0LmZuKCgpID0+IFtdKVxyXG59KSk7XHJcblxyXG4vLyBNb2NrIFRleHRFbmNvZGVyL1RleHREZWNvZGVyIGZvciBOb2RlLmpzXHJcbmNvbnN0IHsgVGV4dEVuY29kZXIsIFRleHREZWNvZGVyIH0gPSByZXF1aXJlKCd1dGlsJyk7XHJcbmdsb2JhbC5UZXh0RW5jb2RlciA9IFRleHRFbmNvZGVyO1xyXG5nbG9iYWwuVGV4dERlY29kZXIgPSBUZXh0RGVjb2RlcjtcclxuXHJcbi8vIE1vY2sgYnRvYS9hdG9iIGZvciBOb2RlLmpzXHJcbmdsb2JhbC5idG9hID0gZ2xvYmFsLmJ0b2EgfHwgKChzdHI6IHN0cmluZykgPT4gQnVmZmVyLmZyb20oc3RyLCAnYmluYXJ5JykudG9TdHJpbmcoJ2Jhc2U2NCcpKTtcclxuZ2xvYmFsLmF0b2IgPSBnbG9iYWwuYXRvYiB8fCAoKHN0cjogc3RyaW5nKSA9PiBCdWZmZXIuZnJvbShzdHIsICdiYXNlNjQnKS50b1N0cmluZygnYmluYXJ5JykpO1xyXG5cclxuLy8gTW9jayBjcnlwdG8gZm9yIFdlYkNyeXB0b1xyXG5jb25zdCBtb2NrQ3J5cHRvS2V5ID0ge1xyXG4gIHR5cGU6ICdzZWNyZXQnLFxyXG4gIGV4dHJhY3RhYmxlOiB0cnVlLFxyXG4gIGFsZ29yaXRobTogeyBuYW1lOiAnQUVTLUdDTScsIGxlbmd0aDogMjU2IH0sXHJcbiAgdXNhZ2VzOiBbJ2VuY3J5cHQnLCAnZGVjcnlwdCddXHJcbn0gYXMgQ3J5cHRvS2V5O1xyXG5cclxuLy8gQ3JlYXRlIHJlYWxpc3RpYyBtb2NrIGRhdGFcclxuY29uc3QgY3JlYXRlTW9ja0VuY3J5cHRpb25SZXN1bHQgPSAocGxhaW50ZXh0OiBzdHJpbmcpID0+IHtcclxuICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XHJcbiAgY29uc3QgZGF0YSA9IGVuY29kZXIuZW5jb2RlKHBsYWludGV4dCk7XHJcbiAgY29uc3QgaXYgPSBuZXcgVWludDhBcnJheSgxMik7XHJcbiAgY29uc3QgbW9ja0VuY3J5cHRlZCA9IG5ldyBVaW50OEFycmF5KGRhdGEubGVuZ3RoICsgMTYpOyAvLyArMTYgZm9yIGF1dGggdGFnXHJcbiAgZGF0YS5mb3JFYWNoKChieXRlLCBpKSA9PiB7XHJcbiAgICBtb2NrRW5jcnlwdGVkW2ldID0gYnl0ZSBeIDB4QUE7IC8vIFNpbXBsZSBYT1IgZm9yIG1vY2sgZW5jcnlwdGlvblxyXG4gIH0pO1xyXG4gIHJldHVybiBtb2NrRW5jcnlwdGVkLmJ1ZmZlcjtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZU1vY2tEZWNyeXB0aW9uUmVzdWx0ID0gKGVuY3J5cHRlZERhdGE6IEFycmF5QnVmZmVyKSA9PiB7XHJcbiAgY29uc3QgZGF0YSA9IG5ldyBVaW50OEFycmF5KGVuY3J5cHRlZERhdGEpO1xyXG4gIGNvbnN0IGRlY3J5cHRlZCA9IG5ldyBVaW50OEFycmF5KGRhdGEubGVuZ3RoIC0gMTYpOyAvLyAtMTYgZm9yIGF1dGggdGFnXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBkZWNyeXB0ZWQubGVuZ3RoOyBpKyspIHtcclxuICAgIGRlY3J5cHRlZFtpXSA9IGRhdGFbaV0gXiAweEFBOyAvLyBSZXZlcnNlIFhPUlxyXG4gIH1cclxuICByZXR1cm4gZGVjcnlwdGVkLmJ1ZmZlcjtcclxufTtcclxuXHJcbi8vIEVuaGFuY2VkIGNyeXB0byBtb2NrXHJcbmNvbnN0IGNyeXB0b1N1YnRsZSA9IHtcclxuICBnZW5lcmF0ZUtleTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDcnlwdG9LZXkpLFxyXG4gIGltcG9ydEtleTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDcnlwdG9LZXkpLFxyXG4gIGV4cG9ydEtleTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG5ldyBBcnJheUJ1ZmZlcigzMikpLFxyXG4gIGVuY3J5cHQ6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oYXN5bmMgKGFsZ29yaXRobSwga2V5LCBkYXRhKSA9PiB7XHJcbiAgICBjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XHJcbiAgICBjb25zdCBwbGFpbnRleHQgPSBkZWNvZGVyLmRlY29kZShkYXRhKTtcclxuICAgIHJldHVybiBjcmVhdGVNb2NrRW5jcnlwdGlvblJlc3VsdChwbGFpbnRleHQpO1xyXG4gIH0pLFxyXG4gIGRlY3J5cHQ6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oYXN5bmMgKGFsZ29yaXRobSwga2V5LCBkYXRhKSA9PiB7XHJcbiAgICByZXR1cm4gY3JlYXRlTW9ja0RlY3J5cHRpb25SZXN1bHQoZGF0YSk7XHJcbiAgfSksXHJcbiAgZGlnZXN0OiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKGFzeW5jIChhbGdvcml0aG0sIGRhdGEpID0+IHtcclxuICAgIC8vIE1vY2sgU0hBLTI1NiBoYXNoIC0gY3JlYXRlIHJlYWxpc3RpYyBvdXRwdXRcclxuICAgIGNvbnN0IGlucHV0ID0gZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyID8gbmV3IFVpbnQ4QXJyYXkoZGF0YSkgOiBkYXRhO1xyXG4gICAgY29uc3QgaGFzaCA9IG5ldyBVaW50OEFycmF5KDMyKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzI7IGkrKykge1xyXG4gICAgICBoYXNoW2ldID0gKGlucHV0W2kgJSBpbnB1dC5sZW5ndGhdICsgaSkgJSAyNTY7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaGFzaC5idWZmZXI7XHJcbiAgfSlcclxufTtcclxuXHJcbmNvbnN0IGNyeXB0b0dldFJhbmRvbVZhbHVlcyA9IGplc3QuZm4oKGFycikgPT4ge1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBhcnJbaV0gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyNTYpO1xyXG4gIH1cclxuICByZXR1cm4gYXJyO1xyXG59KTtcclxuXHJcbmdsb2JhbC5jcnlwdG8gPSBnbG9iYWwuY3J5cHRvIHx8IHt9O1xyXG5nbG9iYWwuY3J5cHRvLnN1YnRsZSA9IGNyeXB0b1N1YnRsZTtcclxuZ2xvYmFsLmNyeXB0by5nZXRSYW5kb21WYWx1ZXMgPSBjcnlwdG9HZXRSYW5kb21WYWx1ZXM7XHJcblxyXG4vLyBNb2NrIHN3Q3J5cHRvQVBJIGZvciBTZWN1cml0eU1hbmFnZXJcclxuamVzdC5tb2NrKCcuLi9zcmMvYmFja2dyb3VuZC9zZXJ2aWNlLXdvcmtlci1hZGFwdGVyJywgKCkgPT4gKHtcclxuICBzd0NyeXB0b0FQSToge1xyXG4gICAgc3VidGxlOiBjcnlwdG9TdWJ0bGUsXHJcbiAgICBnZXRSYW5kb21WYWx1ZXM6IGNyeXB0b0dldFJhbmRvbVZhbHVlc1xyXG4gIH1cclxufSkpO1xyXG5cclxuLy8gTW9jayByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgYW5kIGNhbmNlbEFuaW1hdGlvbkZyYW1lXHJcbmdsb2JhbC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBqZXN0LmZuKChjYWxsYmFjaykgPT4ge1xyXG4gIHJldHVybiBzZXRUaW1lb3V0KGNhbGxiYWNrLCAxNik7IC8vIH42MGZwc1xyXG59KTtcclxuXHJcbmdsb2JhbC5jYW5jZWxBbmltYXRpb25GcmFtZSA9IGplc3QuZm4oKGlkKSA9PiB7XHJcbiAgY2xlYXJUaW1lb3V0KGlkKTtcclxufSk7XHJcblxyXG4vLyBNb2NrIFVSTC5jcmVhdGVPYmplY3RVUkwgZm9yIFdlYiBXb3JrZXJzXHJcbmdsb2JhbC5VUkwgPSBnbG9iYWwuVVJMIHx8IHt9O1xyXG5nbG9iYWwuVVJMLmNyZWF0ZU9iamVjdFVSTCA9IGplc3QuZm4oKCkgPT4gJ2Jsb2I6bW9jay11cmwnKTtcclxuZ2xvYmFsLlVSTC5yZXZva2VPYmplY3RVUkwgPSBqZXN0LmZuKCk7XHJcblxyXG4vLyBNb2NrIFdvcmtlciBjb25zdHJ1Y3RvclxyXG5nbG9iYWwuV29ya2VyID0gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAoe1xyXG4gIHBvc3RNZXNzYWdlOiBqZXN0LmZuKCksXHJcbiAgdGVybWluYXRlOiBqZXN0LmZuKCksXHJcbiAgYWRkRXZlbnRMaXN0ZW5lcjogamVzdC5mbigpLFxyXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXI6IGplc3QuZm4oKSxcclxuICBvbm1lc3NhZ2U6IG51bGwsXHJcbiAgb25lcnJvcjogbnVsbFxyXG59KSk7XHJcblxyXG4vLyBNb2NrIFdlYkdMIGNvbnRleHRcclxuY29uc3QgY3JlYXRlTW9ja1dlYkdMQ29udGV4dCA9ICgpID0+ICh7XHJcbiAgLy8gV2ViR0wgY29uc3RhbnRzXHJcbiAgVFJJQU5HTEVTOiA0LFxyXG4gIExJTkVTOiAxLFxyXG4gIFBPSU5UUzogMCxcclxuICBBUlJBWV9CVUZGRVI6IDM0OTYyLFxyXG4gIEVMRU1FTlRfQVJSQVlfQlVGRkVSOiAzNDk2MyxcclxuICBEWU5BTUlDX0RSQVc6IDM1MDQ4LFxyXG4gIFNUQVRJQ19EUkFXOiAzNTA0NCxcclxuICBGTE9BVDogNTEyNixcclxuICBVTlNJR05FRF9TSE9SVDogNTEyMyxcclxuICBcclxuICAvLyBCdWZmZXIgbWV0aG9kc1xyXG4gIGNyZWF0ZUJ1ZmZlcjogamVzdC5mbigoKSA9PiAoeyBpZDogTWF0aC5yYW5kb20oKSB9KSksXHJcbiAgZGVsZXRlQnVmZmVyOiBqZXN0LmZuKCksXHJcbiAgYmluZEJ1ZmZlcjogamVzdC5mbigpLFxyXG4gIGJ1ZmZlckRhdGE6IGplc3QuZm4oKSxcclxuICBcclxuICAvLyBWZXJ0ZXggYXR0cmlidXRlc1xyXG4gIHZlcnRleEF0dHJpYlBvaW50ZXI6IGplc3QuZm4oKSxcclxuICBlbmFibGVWZXJ0ZXhBdHRyaWJBcnJheTogamVzdC5mbigpLFxyXG4gIGRpc2FibGVWZXJ0ZXhBdHRyaWJBcnJheTogamVzdC5mbigpLFxyXG4gIFxyXG4gIC8vIERyYXdpbmdcclxuICBkcmF3QXJyYXlzOiBqZXN0LmZuKCksXHJcbiAgZHJhd0VsZW1lbnRzOiBqZXN0LmZuKCksXHJcbiAgXHJcbiAgLy8gU2hhZGVycyAoZm9yIGZ1dHVyZSB0ZXN0cylcclxuICBjcmVhdGVTaGFkZXI6IGplc3QuZm4oKCkgPT4gKHsgaWQ6IE1hdGgucmFuZG9tKCkgfSkpLFxyXG4gIGNyZWF0ZVByb2dyYW06IGplc3QuZm4oKCkgPT4gKHsgaWQ6IE1hdGgucmFuZG9tKCkgfSkpLFxyXG4gIGNvbXBpbGVTaGFkZXI6IGplc3QuZm4oKSxcclxuICBsaW5rUHJvZ3JhbTogamVzdC5mbigpLFxyXG4gIHVzZVByb2dyYW06IGplc3QuZm4oKSxcclxuICBcclxuICAvLyBTdGF0ZVxyXG4gIHZpZXdwb3J0OiBqZXN0LmZuKCksXHJcbiAgY2xlYXI6IGplc3QuZm4oKSxcclxuICBjbGVhckNvbG9yOiBqZXN0LmZuKCksXHJcbiAgZW5hYmxlOiBqZXN0LmZuKCksXHJcbiAgZGlzYWJsZTogamVzdC5mbigpLFxyXG4gIFxyXG4gIC8vIEVycm9yIGNoZWNraW5nXHJcbiAgZ2V0RXJyb3I6IGplc3QuZm4oKCkgPT4gMCksIC8vIEdMX05PX0VSUk9SXHJcbiAgXHJcbiAgLy8gRXh0ZW5zaW9uc1xyXG4gIGdldEV4dGVuc2lvbjogamVzdC5mbigpLFxyXG4gIGdldFN1cHBvcnRlZEV4dGVuc2lvbnM6IGplc3QuZm4oKCkgPT4gW10pXHJcbn0pO1xyXG5cclxuLy8gTW9jayBjYW52YXMgYW5kIFdlYkdMXHJcbihIVE1MQ2FudmFzRWxlbWVudC5wcm90b3R5cGUuZ2V0Q29udGV4dCBhcyBqZXN0Lk1vY2spID0gamVzdC5mbigoY29udGV4dFR5cGUpID0+IHtcclxuICBpZiAoY29udGV4dFR5cGUgPT09ICd3ZWJnbCcgfHwgY29udGV4dFR5cGUgPT09ICdleHBlcmltZW50YWwtd2ViZ2wnKSB7XHJcbiAgICByZXR1cm4gY3JlYXRlTW9ja1dlYkdMQ29udGV4dCgpIGFzIHVua25vd24gYXMgV2ViR0xSZW5kZXJpbmdDb250ZXh0O1xyXG4gIH1cclxuICBpZiAoY29udGV4dFR5cGUgPT09ICd3ZWJnbDInKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAuLi5jcmVhdGVNb2NrV2ViR0xDb250ZXh0KCksXHJcbiAgICAgIGNyZWF0ZVZlcnRleEFycmF5OiBqZXN0LmZuKCgpID0+ICh7IGlkOiBNYXRoLnJhbmRvbSgpIH0pKSxcclxuICAgICAgZGVsZXRlVmVydGV4QXJyYXk6IGplc3QuZm4oKSxcclxuICAgICAgYmluZFZlcnRleEFycmF5OiBqZXN0LmZuKClcclxuICAgIH0gYXMgdW5rbm93biBhcyBXZWJHTDJSZW5kZXJpbmdDb250ZXh0O1xyXG4gIH1cclxuICByZXR1cm4gbnVsbDtcclxufSk7XHJcblxyXG4vLyBNb2NrIENocm9tZSBBUElzIGZvciBleHRlbnNpb24gdGVzdGluZ1xyXG5jb25zdCBtb2NrU3RvcmFnZURhdGE6IHsgW2tleTogc3RyaW5nXTogYW55IH0gPSB7fTtcclxuXHJcbihnbG9iYWwgYXMgYW55KS5jaHJvbWUgPSB7XHJcbiAgcnVudGltZToge1xyXG4gICAgb25NZXNzYWdlOiB7XHJcbiAgICAgIGFkZExpc3RlbmVyOiBqZXN0LmZuKCksXHJcbiAgICAgIHJlbW92ZUxpc3RlbmVyOiBqZXN0LmZuKClcclxuICAgIH0gYXMgUGFydGlhbDxjaHJvbWUuZXZlbnRzLkV2ZW50PGFueT4+LFxyXG4gICAgc2VuZE1lc3NhZ2U6IGplc3QuZm4oKSxcclxuICAgIGdldFVSTDogamVzdC5mbigocGF0aDogc3RyaW5nKSA9PiBgY2hyb21lLWV4dGVuc2lvbjovL21vY2staWQvJHtwYXRofWApXHJcbiAgfSBhcyBQYXJ0aWFsPHR5cGVvZiBjaHJvbWUucnVudGltZT4sXHJcbiAgdGFiczoge1xyXG4gICAgcXVlcnk6IGplc3QuZm4oKSxcclxuICAgIGNyZWF0ZTogamVzdC5mbigpLFxyXG4gICAgdXBkYXRlOiBqZXN0LmZuKClcclxuICB9IGFzIFBhcnRpYWw8dHlwZW9mIGNocm9tZS50YWJzPixcclxuICBzdG9yYWdlOiB7XHJcbiAgICBsb2NhbDoge1xyXG4gICAgICBnZXQ6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKGtleXM/OiBzdHJpbmcgfCBzdHJpbmdbXSB8IG51bGwsIGNhbGxiYWNrPzogKHJlc3VsdDogeyBba2V5OiBzdHJpbmddOiBhbnkgfSkgPT4gdm9pZCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdDogeyBba2V5OiBzdHJpbmddOiBhbnkgfSA9IHt9O1xyXG4gICAgICAgIGlmICh0eXBlb2Yga2V5cyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgIGlmIChtb2NrU3RvcmFnZURhdGFba2V5c10gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXN1bHRba2V5c10gPSBtb2NrU3RvcmFnZURhdGFba2V5c107XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGtleXMpKSB7XHJcbiAgICAgICAgICBrZXlzLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgaWYgKG1vY2tTdG9yYWdlRGF0YVtrZXldICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IG1vY2tTdG9yYWdlRGF0YVtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgT2JqZWN0LmFzc2lnbihyZXN1bHQsIG1vY2tTdG9yYWdlRGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2socmVzdWx0KTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgIH0pLFxyXG4gICAgICBzZXQ6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKGl0ZW1zOiB7IFtrZXk6IHN0cmluZ106IGFueSB9LCBjYWxsYmFjaz86ICgpID0+IHZvaWQpID0+IHtcclxuICAgICAgICBPYmplY3QuYXNzaWduKG1vY2tTdG9yYWdlRGF0YSwgaXRlbXMpO1xyXG4gICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgIH0pLFxyXG4gICAgICByZW1vdmU6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKGtleXM6IHN0cmluZyB8IHN0cmluZ1tdLCBjYWxsYmFjaz86ICgpID0+IHZvaWQpID0+IHtcclxuICAgICAgICBjb25zdCBrZXlzQXJyYXkgPSBBcnJheS5pc0FycmF5KGtleXMpID8ga2V5cyA6IFtrZXlzXTtcclxuICAgICAgICBrZXlzQXJyYXkuZm9yRWFjaChrZXkgPT4gZGVsZXRlIG1vY2tTdG9yYWdlRGF0YVtrZXldKTtcclxuICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICB9KSxcclxuICAgICAgY2xlYXI6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKGNhbGxiYWNrPzogKCkgPT4gdm9pZCkgPT4ge1xyXG4gICAgICAgIE9iamVjdC5rZXlzKG1vY2tTdG9yYWdlRGF0YSkuZm9yRWFjaChrZXkgPT4gZGVsZXRlIG1vY2tTdG9yYWdlRGF0YVtrZXldKTtcclxuICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICB9KVxyXG4gICAgfSBhcyBQYXJ0aWFsPGNocm9tZS5zdG9yYWdlLkxvY2FsU3RvcmFnZUFyZWE+LFxyXG4gICAgc3luYzoge1xyXG4gICAgICBnZXQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSksXHJcbiAgICAgIHNldDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCksXHJcbiAgICAgIHJlbW92ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCksXHJcbiAgICAgIGNsZWFyOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKVxyXG4gICAgfSBhcyBQYXJ0aWFsPGNocm9tZS5zdG9yYWdlLlN5bmNTdG9yYWdlQXJlYT5cclxuICB9IGFzIFBhcnRpYWw8dHlwZW9mIGNocm9tZS5zdG9yYWdlPlxyXG59O1xyXG5cclxuLy8gQ29uc29sZSBvdmVycmlkZSBmb3IgdGVzdCBjbGVhbnVwXHJcbmNvbnN0IG9yaWdpbmFsQ29uc29sZSA9IGdsb2JhbC5jb25zb2xlO1xyXG5nbG9iYWwuY29uc29sZSA9IHtcclxuICAuLi5vcmlnaW5hbENvbnNvbGUsXHJcbiAgLy8gU3VwcHJlc3MgY29uc29sZS5sb2cgaW4gdGVzdHMgdW5sZXNzIGV4cGxpY2l0bHkgbmVlZGVkXHJcbiAgbG9nOiBwcm9jZXNzLmVudi5KRVNUX1ZFUkJPU0UgPT09ICd0cnVlJyA/IG9yaWdpbmFsQ29uc29sZS5sb2cgOiBqZXN0LmZuKCksXHJcbiAgaW5mbzogcHJvY2Vzcy5lbnYuSkVTVF9WRVJCT1NFID09PSAndHJ1ZScgPyBvcmlnaW5hbENvbnNvbGUuaW5mbyA6IGplc3QuZm4oKSxcclxuICB3YXJuOiBvcmlnaW5hbENvbnNvbGUud2FybixcclxuICBlcnJvcjogb3JpZ2luYWxDb25zb2xlLmVycm9yLFxyXG4gIGRlYnVnOiBwcm9jZXNzLmVudi5KRVNUX1ZFUkJPU0UgPT09ICd0cnVlJyA/IG9yaWdpbmFsQ29uc29sZS5kZWJ1ZyA6IGplc3QuZm4oKVxyXG59O1xyXG5cclxuLy8gSW5jcmVhc2UgdGltZW91dCBmb3IgaW50ZWdyYXRpb24gdGVzdHNcclxuamVzdC5zZXRUaW1lb3V0KDEwMDAwKTtcclxuXHJcbi8vIEdsb2JhbCB0ZXN0IHV0aWxpdGllc1xyXG5nbG9iYWwudGVzdFV0aWxzID0ge1xyXG4gIC8vIEhlbHBlciB0byB3YWl0IGZvciBhc3luYyBvcGVyYXRpb25zXHJcbiAgd2FpdEZvcjogKG1zOiBudW1iZXIpID0+IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpLFxyXG4gIFxyXG4gIC8vIEhlbHBlciB0byBjcmVhdGUgbW9jayBETkEgc2VxdWVuY2VzXHJcbiAgY3JlYXRlTW9ja0ROQTogKGxlbmd0aDogbnVtYmVyID0gMTYpID0+IHtcclxuICAgIGNvbnN0IGJhc2VzID0gWydBJywgJ1QnLCAnQycsICdHJ107XHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aCB9LCAoKSA9PiBiYXNlc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBiYXNlcy5sZW5ndGgpXSkuam9pbignJyk7XHJcbiAgfSxcclxuICBcclxuICAvLyBIZWxwZXIgdG8gY3JlYXRlIHZhbGlkIG9yZ2FuaXNtIHRyYWl0c1xyXG4gIGNyZWF0ZU1vY2tUcmFpdHM6ICgpID0+ICh7XHJcbiAgICBjdXJpb3NpdHk6IE1hdGgucmFuZG9tKCksXHJcbiAgICBmb2N1czogTWF0aC5yYW5kb20oKSxcclxuICAgIHJoeXRobTogTWF0aC5yYW5kb20oKSxcclxuICAgIGVtcGF0aHk6IE1hdGgucmFuZG9tKCksXHJcbiAgICBjcmVhdGl2aXR5OiBNYXRoLnJhbmRvbSgpLFxyXG4gICAgcmVzaWxpZW5jZTogTWF0aC5yYW5kb20oKSxcclxuICAgIGFkYXB0YWJpbGl0eTogTWF0aC5yYW5kb20oKSxcclxuICAgIG1lbW9yeTogTWF0aC5yYW5kb20oKSxcclxuICAgIGludHVpdGlvbjogTWF0aC5yYW5kb20oKSAqIDAuMiAvLyBJbnR1aXRpb24gaXMgdHlwaWNhbGx5IGxvd2VyXHJcbiAgfSksXHJcbiAgXHJcbiAgLy8gSGVscGVyIHRvIHN1cHByZXNzIGNvbnNvbGUgb3V0cHV0IGR1cmluZyB0ZXN0c1xyXG4gIHN1cHByZXNzQ29uc29sZTogKCkgPT4ge1xyXG4gICAgY29uc3Qgc3B5ID0ge1xyXG4gICAgICBsb2c6IGplc3Quc3B5T24oY29uc29sZSwgJ2xvZycpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSksXHJcbiAgICAgIGluZm86IGplc3Quc3B5T24oY29uc29sZSwgJ2luZm8nKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pLFxyXG4gICAgICB3YXJuOiBqZXN0LnNweU9uKGNvbnNvbGUsICd3YXJuJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KSxcclxuICAgICAgZXJyb3I6IGplc3Quc3B5T24oY29uc29sZSwgJ2Vycm9yJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KSxcclxuICAgICAgZGVidWc6IGplc3Quc3B5T24oY29uc29sZSwgJ2RlYnVnJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgT2JqZWN0LnZhbHVlcyhzcHkpLmZvckVhY2gocyA9PiBzLm1vY2tSZXN0b3JlKCkpO1xyXG4gICAgfTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBDbGVhbiB1cCBhZnRlciBlYWNoIHRlc3RcclxuYWZ0ZXJFYWNoKCgpID0+IHtcclxuICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICBqZXN0LmNsZWFyQWxsVGltZXJzKCk7XHJcbiAgXHJcbiAgLy8gQ2xlYXIgbW9jayBzdG9yYWdlIGRhdGFcclxuICBPYmplY3Qua2V5cyhtb2NrU3RvcmFnZURhdGEpLmZvckVhY2goa2V5ID0+IGRlbGV0ZSBtb2NrU3RvcmFnZURhdGFba2V5XSk7XHJcbiAgXHJcbiAgLy8gUmVzZXQgcGVyZm9ybWFuY2UgbW9jayBpZiBpdCBleGlzdHMgYW5kIGlzIGEgSmVzdCBtb2NrXHJcbiAgaWYgKGdsb2JhbC5wZXJmb3JtYW5jZS5ub3cgJiYgdHlwZW9mIChnbG9iYWwucGVyZm9ybWFuY2Uubm93IGFzIGFueSkubW9ja0NsZWFyID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAoZ2xvYmFsLnBlcmZvcm1hbmNlLm5vdyBhcyBqZXN0Lk1vY2spLm1vY2tDbGVhcigpO1xyXG4gIH1cclxuICBcclxuICAvLyBSZXNldCBSQUYgbW9ja3MgaWYgdGhleSBleGlzdCBhbmQgYXJlIEplc3QgbW9ja3NcclxuICBpZiAoZ2xvYmFsLnJlcXVlc3RBbmltYXRpb25GcmFtZSAmJiB0eXBlb2YgKGdsb2JhbC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgYXMgYW55KS5tb2NrQ2xlYXIgPT09ICdmdW5jdGlvbicpIHtcclxuICAgIChnbG9iYWwucmVxdWVzdEFuaW1hdGlvbkZyYW1lIGFzIGplc3QuTW9jaykubW9ja0NsZWFyKCk7XHJcbiAgfVxyXG4gIGlmIChnbG9iYWwuY2FuY2VsQW5pbWF0aW9uRnJhbWUgJiYgdHlwZW9mIChnbG9iYWwuY2FuY2VsQW5pbWF0aW9uRnJhbWUgYXMgYW55KS5tb2NrQ2xlYXIgPT09ICdmdW5jdGlvbicpIHtcclxuICAgIChnbG9iYWwuY2FuY2VsQW5pbWF0aW9uRnJhbWUgYXMgamVzdC5Nb2NrKS5tb2NrQ2xlYXIoKTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gVHlwZVNjcmlwdCBkZWNsYXJhdGlvbnMgZm9yIGdsb2JhbCB0ZXN0IHV0aWxpdGllc1xyXG5kZWNsYXJlIGdsb2JhbCB7XHJcbiAgdmFyIHRlc3RVdGlsczoge1xyXG4gICAgd2FpdEZvcjogKG1zOiBudW1iZXIpID0+IFByb21pc2U8dm9pZD47XHJcbiAgICBjcmVhdGVNb2NrRE5BOiAobGVuZ3RoPzogbnVtYmVyKSA9PiBzdHJpbmc7XHJcbiAgICBjcmVhdGVNb2NrVHJhaXRzOiAoKSA9PiBhbnk7XHJcbiAgICBzdXBwcmVzc0NvbnNvbGU6ICgpID0+ICgpID0+IHZvaWQ7XHJcbiAgfTtcclxufSAiXSwidmVyc2lvbiI6M30=