039b53e1ece52883d36a153aa8452496
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const SecurityManager_1 = require("../src/background/SecurityManager");
describe('SecurityManager', () => {
    const security = new SecurityManager_1.SecurityManager();
    it('chiffre et déchiffre correctement les données', async () => {
        const data = { foo: 'bar', n: 42 };
        const encrypted = await security.encryptSensitiveData(data);
        expect(typeof encrypted).toBe('string');
        const decrypted = await security.decryptSensitiveData(encrypted);
        expect(decrypted).toEqual(data);
    });
    it('anonymise les données comportementales', () => {
        const pattern = { url: 'https://secret.com', interactions: 5, timeSpent: 10, scrollDepth: 0.8, timestamp: Date.now() };
        const anonymized = security.anonymizeForSharing(pattern);
        expect(anonymized.url).toBe('anonymized');
        expect(anonymized.interactions).toBe(pattern.interactions);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL21udC9jL1VzZXJzL21fb2xpL1Byb2pldHMvU1lNQklPTlQvX190ZXN0c19fL1NlY3VyaXR5TWFuYWdlci50ZXN0LnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsdUVBQW1FO0FBRW5FLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7SUFDL0IsTUFBTSxRQUFRLEdBQUcsSUFBSSxpQ0FBZSxFQUFFLENBQUE7SUFFdEMsRUFBRSxDQUFDLCtDQUErQyxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzdELE1BQU0sSUFBSSxHQUFHLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUE7UUFDbEMsTUFBTSxTQUFTLEdBQUcsTUFBTSxRQUFRLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLENBQUE7UUFDM0QsTUFBTSxDQUFDLE9BQU8sU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFBO1FBQ3ZDLE1BQU0sU0FBUyxHQUFHLE1BQU0sUUFBUSxDQUFDLG9CQUFvQixDQUFDLFNBQVMsQ0FBQyxDQUFBO1FBQ2hFLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDakMsQ0FBQyxDQUFDLENBQUE7SUFFRixFQUFFLENBQUMsd0NBQXdDLEVBQUUsR0FBRyxFQUFFO1FBQ2hELE1BQU0sT0FBTyxHQUFHLEVBQUUsR0FBRyxFQUFFLG9CQUFvQixFQUFFLFlBQVksRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRSxXQUFXLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQTtRQUN0SCxNQUFNLFVBQVUsR0FBRyxRQUFRLENBQUMsbUJBQW1CLENBQUMsT0FBTyxDQUFDLENBQUE7UUFDeEQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUE7UUFDekMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFBO0lBQzVELENBQUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQyxDQUFDLENBQUEiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL21udC9jL1VzZXJzL21fb2xpL1Byb2pldHMvU1lNQklPTlQvX190ZXN0c19fL1NlY3VyaXR5TWFuYWdlci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNlY3VyaXR5TWFuYWdlciB9IGZyb20gJy4uL3NyYy9iYWNrZ3JvdW5kL1NlY3VyaXR5TWFuYWdlcidcclxuXHJcbmRlc2NyaWJlKCdTZWN1cml0eU1hbmFnZXInLCAoKSA9PiB7XHJcbiAgY29uc3Qgc2VjdXJpdHkgPSBuZXcgU2VjdXJpdHlNYW5hZ2VyKClcclxuXHJcbiAgaXQoJ2NoaWZmcmUgZXQgZMOpY2hpZmZyZSBjb3JyZWN0ZW1lbnQgbGVzIGRvbm7DqWVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgZGF0YSA9IHsgZm9vOiAnYmFyJywgbjogNDIgfVxyXG4gICAgY29uc3QgZW5jcnlwdGVkID0gYXdhaXQgc2VjdXJpdHkuZW5jcnlwdFNlbnNpdGl2ZURhdGEoZGF0YSlcclxuICAgIGV4cGVjdCh0eXBlb2YgZW5jcnlwdGVkKS50b0JlKCdzdHJpbmcnKVxyXG4gICAgY29uc3QgZGVjcnlwdGVkID0gYXdhaXQgc2VjdXJpdHkuZGVjcnlwdFNlbnNpdGl2ZURhdGEoZW5jcnlwdGVkKVxyXG4gICAgZXhwZWN0KGRlY3J5cHRlZCkudG9FcXVhbChkYXRhKVxyXG4gIH0pXHJcblxyXG4gIGl0KCdhbm9ueW1pc2UgbGVzIGRvbm7DqWVzIGNvbXBvcnRlbWVudGFsZXMnLCAoKSA9PiB7XHJcbiAgICBjb25zdCBwYXR0ZXJuID0geyB1cmw6ICdodHRwczovL3NlY3JldC5jb20nLCBpbnRlcmFjdGlvbnM6IDUsIHRpbWVTcGVudDogMTAsIHNjcm9sbERlcHRoOiAwLjgsIHRpbWVzdGFtcDogRGF0ZS5ub3coKSB9XHJcbiAgICBjb25zdCBhbm9ueW1pemVkID0gc2VjdXJpdHkuYW5vbnltaXplRm9yU2hhcmluZyhwYXR0ZXJuKVxyXG4gICAgZXhwZWN0KGFub255bWl6ZWQudXJsKS50b0JlKCdhbm9ueW1pemVkJylcclxuICAgIGV4cGVjdChhbm9ueW1pemVkLmludGVyYWN0aW9ucykudG9CZShwYXR0ZXJuLmludGVyYWN0aW9ucylcclxuICB9KVxyXG59KSAiXSwidmVyc2lvbiI6M30=