{"version":3,"names":["cov_1rrnu3a8n6","actualCoverage","s","secureLogger_1","require","MessageBus_1","WebGLMessageAdapter","constructor","engine","messageBus","f","setupListeners","on","MessageType","ORGANISM_MUTATE","message","mutation","payload","mutate","_err","logger","error","ORGANISM_STATE_CHANGE","state","render","setInterval","metrics","getPerformanceMetrics","send","type","PERFORMANCE_UPDATE","exports"],"sources":["/mnt/c/Users/m_oli/Projets/SYMBIONT/src/integration/WebGLMessageAdapter.ts"],"sourcesContent":["// src/integration/WebGLMessageAdapter.ts\r\nimport { OrganismEngine } from '../generative/OrganismEngine';\r\nimport { OrganismState, OrganismMutation } from '../shared/types/organism';\r\nimport { logger } from '@shared/utils/secureLogger';\r\n\r\n// MessageBus et MessageType doivent être importés selon votre architecture\r\nimport { MessageBus, MessageType } from '../shared/messaging/MessageBus';\r\n\r\n/**\r\n * Adaptateur entre le bus de messages et le moteur WebGL\r\n */\r\nexport class WebGLMessageAdapter {\r\n    private engine: OrganismEngine;\r\n    private messageBus: MessageBus;\r\n    \r\n    constructor(engine: OrganismEngine, messageBus: MessageBus) {\r\n      this.engine = engine;\r\n      this.messageBus = messageBus;\r\n      this.setupListeners();\r\n    }\r\n    \r\n  /**\r\n   * Mise en place des listeners sur le bus de messages\r\n   */\r\n    private setupListeners(): void {\r\n      // Écoute des mutations\r\n    this.messageBus.on(MessageType.ORGANISM_MUTATE, (message: MessageEvent | unknown) => {\r\n      try {\r\n        const { mutation } = (message as any).payload;\r\n        this.engine.mutate(mutation as OrganismMutation);\r\n      } catch (_err) {\r\n        logger.error('Erreur lors de l\\'application de la mutation WebGL :', _err);\r\n      }\r\n      });\r\n      \r\n      // Écoute des changements d'état\r\n    this.messageBus.on(MessageType.ORGANISM_STATE_CHANGE, (message: MessageEvent | unknown) => {\r\n      try {\r\n        const { state } = (message as any).payload;\r\n        this.engine.render(state as OrganismState);\r\n      } catch (_err) {\r\n        logger.error('Erreur lors du rendu WebGL :', _err);\r\n      }\r\n      });\r\n      \r\n      // Notification de performance\r\n      setInterval(() => {\r\n      try {\r\n        const metrics = this.engine.getPerformanceMetrics();\r\n        this.messageBus.send({\r\n          type: MessageType.PERFORMANCE_UPDATE,\r\n          payload: metrics\r\n        });\r\n      } catch (_err) {\r\n        // On ignore les erreurs de métriques pour ne pas polluer la console\r\n      }\r\n      }, 1000);\r\n    }\r\n}"],"mappings":"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","ignoreList":[]}