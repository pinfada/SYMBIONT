bf9e793e0120eb4f192c58e971bd3dc7
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Jest setup file for SYMBIONT tests
require("@testing-library/jest-dom");
// Mock global objects that might not be available in test environment
global.performance = global.performance || {};
global.performance.now = jest.fn(() => Date.now());
global.performance.mark = jest.fn();
global.performance.measure = jest.fn();
global.performance.clearMarks = jest.fn();
global.performance.clearMeasures = jest.fn();
global.performance.getEntries = jest.fn(() => []);
global.performance.getEntriesByName = jest.fn(() => []);
global.performance.getEntriesByType = jest.fn(() => []);
// Mock PerformanceObserver
global.PerformanceObserver = jest.fn().mockImplementation((callback) => ({
    observe: jest.fn(),
    disconnect: jest.fn(),
    takeRecords: jest.fn(() => [])
}));
// Mock TextEncoder/TextDecoder for Node.js
const { TextEncoder, TextDecoder } = require('util');
global.TextEncoder = TextEncoder;
global.TextDecoder = TextDecoder;
// Mock btoa/atob for Node.js
global.btoa = global.btoa || ((str) => Buffer.from(str, 'binary').toString('base64'));
global.atob = global.atob || ((str) => Buffer.from(str, 'base64').toString('binary'));
// Mock crypto for WebCrypto
const mockCryptoKey = {};
global.crypto = global.crypto || {};
global.crypto.subtle = global.crypto.subtle || {
    generateKey: jest.fn().mockResolvedValue(mockCryptoKey),
    importKey: jest.fn().mockResolvedValue(mockCryptoKey),
    exportKey: jest.fn().mockResolvedValue(new ArrayBuffer(32)),
    encrypt: jest.fn().mockResolvedValue(new ArrayBuffer(64)),
    decrypt: jest.fn().mockResolvedValue(new ArrayBuffer(32)),
    digest: jest.fn().mockResolvedValue(new ArrayBuffer(32))
};
global.crypto.getRandomValues = jest.fn((arr) => {
    for (let i = 0; i < arr.length; i++) {
        arr[i] = Math.floor(Math.random() * 256);
    }
    return arr;
});
// Mock requestAnimationFrame and cancelAnimationFrame
global.requestAnimationFrame = jest.fn((callback) => {
    return setTimeout(callback, 16); // ~60fps
});
global.cancelAnimationFrame = jest.fn((id) => {
    clearTimeout(id);
});
// Mock URL.createObjectURL for Web Workers
global.URL = global.URL || {};
global.URL.createObjectURL = jest.fn(() => 'blob:mock-url');
global.URL.revokeObjectURL = jest.fn();
// Mock Worker constructor
global.Worker = jest.fn().mockImplementation(() => ({
    postMessage: jest.fn(),
    terminate: jest.fn(),
    addEventListener: jest.fn(),
    removeEventListener: jest.fn(),
    onmessage: null,
    onerror: null
}));
// Mock WebGL context
const createMockWebGLContext = () => ({
    // WebGL constants
    TRIANGLES: 4,
    LINES: 1,
    POINTS: 0,
    ARRAY_BUFFER: 34962,
    ELEMENT_ARRAY_BUFFER: 34963,
    DYNAMIC_DRAW: 35048,
    STATIC_DRAW: 35044,
    FLOAT: 5126,
    UNSIGNED_SHORT: 5123,
    // Buffer methods
    createBuffer: jest.fn(() => ({ id: Math.random() })),
    deleteBuffer: jest.fn(),
    bindBuffer: jest.fn(),
    bufferData: jest.fn(),
    // Vertex attributes
    vertexAttribPointer: jest.fn(),
    enableVertexAttribArray: jest.fn(),
    disableVertexAttribArray: jest.fn(),
    // Drawing
    drawArrays: jest.fn(),
    drawElements: jest.fn(),
    // Shaders (for future tests)
    createShader: jest.fn(() => ({ id: Math.random() })),
    createProgram: jest.fn(() => ({ id: Math.random() })),
    compileShader: jest.fn(),
    linkProgram: jest.fn(),
    useProgram: jest.fn(),
    // State
    viewport: jest.fn(),
    clear: jest.fn(),
    clearColor: jest.fn(),
    enable: jest.fn(),
    disable: jest.fn(),
    // Error checking
    getError: jest.fn(() => 0), // GL_NO_ERROR
    // Extensions
    getExtension: jest.fn(),
    getSupportedExtensions: jest.fn(() => [])
});
// Mock canvas and WebGL
HTMLCanvasElement.prototype.getContext = jest.fn((contextType) => {
    if (contextType === 'webgl' || contextType === 'experimental-webgl') {
        return createMockWebGLContext();
    }
    if (contextType === 'webgl2') {
        return {
            ...createMockWebGLContext(),
            createVertexArray: jest.fn(() => ({ id: Math.random() })),
            deleteVertexArray: jest.fn(),
            bindVertexArray: jest.fn()
        };
    }
    return null;
});
// Mock Chrome APIs for extension testing
global.chrome = {
    runtime: {
        onMessage: {
            addListener: jest.fn(),
            removeListener: jest.fn()
        },
        sendMessage: jest.fn(),
        getURL: jest.fn((path) => `chrome-extension://mock-id/${path}`)
    },
    tabs: {
        query: jest.fn(),
        create: jest.fn(),
        update: jest.fn()
    },
    storage: {
        local: {
            get: jest.fn(),
            set: jest.fn(),
            remove: jest.fn(),
            clear: jest.fn()
        },
        sync: {
            get: jest.fn(),
            set: jest.fn(),
            remove: jest.fn(),
            clear: jest.fn()
        }
    }
};
// Console override for test cleanup
const originalConsole = global.console;
global.console = {
    ...originalConsole,
    // Suppress console.log in tests unless explicitly needed
    log: process.env.JEST_VERBOSE === 'true' ? originalConsole.log : jest.fn(),
    info: process.env.JEST_VERBOSE === 'true' ? originalConsole.info : jest.fn(),
    warn: originalConsole.warn,
    error: originalConsole.error,
    debug: process.env.JEST_VERBOSE === 'true' ? originalConsole.debug : jest.fn()
};
// Increase timeout for integration tests
jest.setTimeout(10000);
// Global test utilities
global.testUtils = {
    // Helper to wait for async operations
    waitFor: (ms) => new Promise(resolve => setTimeout(resolve, ms)),
    // Helper to create mock DNA sequences
    createMockDNA: (length = 16) => {
        const bases = ['A', 'T', 'C', 'G'];
        return Array.from({ length }, () => bases[Math.floor(Math.random() * bases.length)]).join('');
    },
    // Helper to create valid organism traits
    createMockTraits: () => ({
        curiosity: Math.random(),
        focus: Math.random(),
        rhythm: Math.random(),
        empathy: Math.random(),
        creativity: Math.random(),
        energy: Math.random(),
        harmony: Math.random(),
        wisdom: Math.random() * 0.2 // Wisdom is typically lower
    }),
    // Helper to suppress console output during tests
    suppressConsole: () => {
        const spy = {
            log: jest.spyOn(console, 'log').mockImplementation(() => { }),
            info: jest.spyOn(console, 'info').mockImplementation(() => { }),
            warn: jest.spyOn(console, 'warn').mockImplementation(() => { }),
            error: jest.spyOn(console, 'error').mockImplementation(() => { }),
            debug: jest.spyOn(console, 'debug').mockImplementation(() => { })
        };
        return () => {
            Object.values(spy).forEach(s => s.mockRestore());
        };
    }
};
// Clean up after each test
afterEach(() => {
    jest.clearAllMocks();
    jest.clearAllTimers();
    // Reset performance mock if it exists and is a Jest mock
    if (global.performance.now && typeof global.performance.now.mockClear === 'function') {
        global.performance.now.mockClear();
    }
    // Reset RAF mocks if they exist and are Jest mocks
    if (global.requestAnimationFrame && typeof global.requestAnimationFrame.mockClear === 'function') {
        global.requestAnimationFrame.mockClear();
    }
    if (global.cancelAnimationFrame && typeof global.cancelAnimationFrame.mockClear === 'function') {
        global.cancelAnimationFrame.mockClear();
    }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL21udC9jL1VzZXJzL21fb2xpL1Byb2pldHMvU1lNQklPTlQvX190ZXN0c19fL3NldHVwLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEscUNBQXFDO0FBQ3JDLHFDQUFtQztBQUVuQyxzRUFBc0U7QUFDdEUsTUFBTSxDQUFDLFdBQVcsR0FBRyxNQUFNLENBQUMsV0FBVyxJQUFJLEVBQUUsQ0FBQztBQUM5QyxNQUFNLENBQUMsV0FBVyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO0FBQ25ELE1BQU0sQ0FBQyxXQUFXLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztBQUNwQyxNQUFNLENBQUMsV0FBVyxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7QUFDdkMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO0FBQzFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztBQUM3QyxNQUFNLENBQUMsV0FBVyxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ2xELE1BQU0sQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUN4RCxNQUFNLENBQUMsV0FBVyxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7QUFFeEQsMkJBQTJCO0FBQzNCLE1BQU0sQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDdkUsT0FBTyxF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RUFBRTtJQUNiLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUNyQixJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7SUFFdEIseURBQXlEO0lBQ3pELElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFHLElBQUksT0FBUSxNQUFNLENBQUMsV0FBVyxDQUFDLEdBQVcsQ0FBQyxTQUFTLEtBQUssVUFBVSxFQUFFLENBQUM7UUFDN0YsTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFpQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQ3BELENBQUM7SUFFRCxtREFBbUQ7SUFDbkQsSUFBSSxNQUFNLENBQUMscUJBQXFCLElBQUksT0FBUSxNQUFNLENBQUMscUJBQTZCLENBQUMsU0FBUyxLQUFLLFVBQVUsRUFBRSxDQUFDO1FBQ3pHLE1BQU0sQ0FBQyxxQkFBbUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUMxRCxDQUFDO0lBQ0QsSUFBSSxNQUFNLENBQUMsb0JBQW9CLElBQUksT0FBUSxNQUFNLENBQUMsb0JBQTRCLENBQUMsU0FBUyxLQUFLLFVBQVUsRUFBRSxDQUFDO1FBQ3ZHLE1BQU0sQ0FBQyxvQkFBa0MsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUN6RCxDQUFDO0FBQ0gsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL21udC9jL1VzZXJzL21fb2xpL1Byb2pldHMvU1lNQklPTlQvX190ZXN0c19fL3NldHVwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEplc3Qgc2V0dXAgZmlsZSBmb3IgU1lNQklPTlQgdGVzdHNcclxuaW1wb3J0ICdAdGVzdGluZy1saWJyYXJ5L2plc3QtZG9tJztcclxuXHJcbi8vIE1vY2sgZ2xvYmFsIG9iamVjdHMgdGhhdCBtaWdodCBub3QgYmUgYXZhaWxhYmxlIGluIHRlc3QgZW52aXJvbm1lbnRcclxuZ2xvYmFsLnBlcmZvcm1hbmNlID0gZ2xvYmFsLnBlcmZvcm1hbmNlIHx8IHt9O1xyXG5nbG9iYWwucGVyZm9ybWFuY2Uubm93ID0gamVzdC5mbigoKSA9PiBEYXRlLm5vdygpKTtcclxuZ2xvYmFsLnBlcmZvcm1hbmNlLm1hcmsgPSBqZXN0LmZuKCk7XHJcbmdsb2JhbC5wZXJmb3JtYW5jZS5tZWFzdXJlID0gamVzdC5mbigpO1xyXG5nbG9iYWwucGVyZm9ybWFuY2UuY2xlYXJNYXJrcyA9IGplc3QuZm4oKTtcclxuZ2xvYmFsLnBlcmZvcm1hbmNlLmNsZWFyTWVhc3VyZXMgPSBqZXN0LmZuKCk7XHJcbmdsb2JhbC5wZXJmb3JtYW5jZS5nZXRFbnRyaWVzID0gamVzdC5mbigoKSA9PiBbXSk7XHJcbmdsb2JhbC5wZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlOYW1lID0gamVzdC5mbigoKSA9PiBbXSk7XHJcbmdsb2JhbC5wZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlID0gamVzdC5mbigoKSA9PiBbXSk7XHJcblxyXG4vLyBNb2NrIFBlcmZvcm1hbmNlT2JzZXJ2ZXJcclxuZ2xvYmFsLlBlcmZvcm1hbmNlT2JzZXJ2ZXIgPSBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKChjYWxsYmFjaykgPT4gKHtcclxuICBvYnNlcnZlOiBqZXN0LmZuKCksXHJcbiAgZGlzY29ubmVjdDogamVzdC5mbigpLFxyXG4gIHRha2VSZWNvcmRzOiBqZXN0LmZuKCgpID0+IFtdKVxyXG59KSk7XHJcblxyXG4vLyBNb2NrIFRleHRFbmNvZGVyL1RleHREZWNvZGVyIGZvciBOb2RlLmpzXHJcbmNvbnN0IHsgVGV4dEVuY29kZXIsIFRleHREZWNvZGVyIH0gPSByZXF1aXJlKCd1dGlsJyk7XHJcbmdsb2JhbC5UZXh0RW5jb2RlciA9IFRleHRFbmNvZGVyO1xyXG5nbG9iYWwuVGV4dERlY29kZXIgPSBUZXh0RGVjb2RlcjtcclxuXHJcbi8vIE1vY2sgYnRvYS9hdG9iIGZvciBOb2RlLmpzXHJcbmdsb2JhbC5idG9hID0gZ2xvYmFsLmJ0b2EgfHwgKChzdHI6IHN0cmluZykgPT4gQnVmZmVyLmZyb20oc3RyLCAnYmluYXJ5JykudG9TdHJpbmcoJ2Jhc2U2NCcpKTtcclxuZ2xvYmFsLmF0b2IgPSBnbG9iYWwuYXRvYiB8fCAoKHN0cjogc3RyaW5nKSA9PiBCdWZmZXIuZnJvbShzdHIsICdiYXNlNjQnKS50b1N0cmluZygnYmluYXJ5JykpO1xyXG5cclxuLy8gTW9jayBjcnlwdG8gZm9yIFdlYkNyeXB0b1xyXG5jb25zdCBtb2NrQ3J5cHRvS2V5ID0ge30gYXMgQ3J5cHRvS2V5O1xyXG5nbG9iYWwuY3J5cHRvID0gZ2xvYmFsLmNyeXB0byB8fCB7fTtcclxuZ2xvYmFsLmNyeXB0by5zdWJ0bGUgPSBnbG9iYWwuY3J5cHRvLnN1YnRsZSB8fCB7XHJcbiAgZ2VuZXJhdGVLZXk6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ3J5cHRvS2V5KSxcclxuICBpbXBvcnRLZXk6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ3J5cHRvS2V5KSxcclxuICBleHBvcnRLZXk6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShuZXcgQXJyYXlCdWZmZXIoMzIpKSxcclxuICBlbmNyeXB0OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobmV3IEFycmF5QnVmZmVyKDY0KSksXHJcbiAgZGVjcnlwdDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG5ldyBBcnJheUJ1ZmZlcigzMikpLFxyXG4gIGRpZ2VzdDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG5ldyBBcnJheUJ1ZmZlcigzMikpXHJcbn07XHJcbmdsb2JhbC5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzID0gamVzdC5mbigoYXJyKSA9PiB7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuICAgIGFycltpXSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1Nik7XHJcbiAgfVxyXG4gIHJldHVybiBhcnI7XHJcbn0pO1xyXG5cclxuLy8gTW9jayByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgYW5kIGNhbmNlbEFuaW1hdGlvbkZyYW1lXHJcbmdsb2JhbC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBqZXN0LmZuKChjYWxsYmFjaykgPT4ge1xyXG4gIHJldHVybiBzZXRUaW1lb3V0KGNhbGxiYWNrLCAxNik7IC8vIH42MGZwc1xyXG59KTtcclxuXHJcbmdsb2JhbC5jYW5jZWxBbmltYXRpb25GcmFtZSA9IGplc3QuZm4oKGlkKSA9PiB7XHJcbiAgY2xlYXJUaW1lb3V0KGlkKTtcclxufSk7XHJcblxyXG4vLyBNb2NrIFVSTC5jcmVhdGVPYmplY3RVUkwgZm9yIFdlYiBXb3JrZXJzXHJcbmdsb2JhbC5VUkwgPSBnbG9iYWwuVVJMIHx8IHt9O1xyXG5nbG9iYWwuVVJMLmNyZWF0ZU9iamVjdFVSTCA9IGplc3QuZm4oKCkgPT4gJ2Jsb2I6bW9jay11cmwnKTtcclxuZ2xvYmFsLlVSTC5yZXZva2VPYmplY3RVUkwgPSBqZXN0LmZuKCk7XHJcblxyXG4vLyBNb2NrIFdvcmtlciBjb25zdHJ1Y3RvclxyXG5nbG9iYWwuV29ya2VyID0gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAoe1xyXG4gIHBvc3RNZXNzYWdlOiBqZXN0LmZuKCksXHJcbiAgdGVybWluYXRlOiBqZXN0LmZuKCksXHJcbiAgYWRkRXZlbnRMaXN0ZW5lcjogamVzdC5mbigpLFxyXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXI6IGplc3QuZm4oKSxcclxuICBvbm1lc3NhZ2U6IG51bGwsXHJcbiAgb25lcnJvcjogbnVsbFxyXG59KSk7XHJcblxyXG4vLyBNb2NrIFdlYkdMIGNvbnRleHRcclxuY29uc3QgY3JlYXRlTW9ja1dlYkdMQ29udGV4dCA9ICgpID0+ICh7XHJcbiAgLy8gV2ViR0wgY29uc3RhbnRzXHJcbiAgVFJJQU5HTEVTOiA0LFxyXG4gIExJTkVTOiAxLFxyXG4gIFBPSU5UUzogMCxcclxuICBBUlJBWV9CVUZGRVI6IDM0OTYyLFxyXG4gIEVMRU1FTlRfQVJSQVlfQlVGRkVSOiAzNDk2MyxcclxuICBEWU5BTUlDX0RSQVc6IDM1MDQ4LFxyXG4gIFNUQVRJQ19EUkFXOiAzNTA0NCxcclxuICBGTE9BVDogNTEyNixcclxuICBVTlNJR05FRF9TSE9SVDogNTEyMyxcclxuICBcclxuICAvLyBCdWZmZXIgbWV0aG9kc1xyXG4gIGNyZWF0ZUJ1ZmZlcjogamVzdC5mbigoKSA9PiAoeyBpZDogTWF0aC5yYW5kb20oKSB9KSksXHJcbiAgZGVsZXRlQnVmZmVyOiBqZXN0LmZuKCksXHJcbiAgYmluZEJ1ZmZlcjogamVzdC5mbigpLFxyXG4gIGJ1ZmZlckRhdGE6IGplc3QuZm4oKSxcclxuICBcclxuICAvLyBWZXJ0ZXggYXR0cmlidXRlc1xyXG4gIHZlcnRleEF0dHJpYlBvaW50ZXI6IGplc3QuZm4oKSxcclxuICBlbmFibGVWZXJ0ZXhBdHRyaWJBcnJheTogamVzdC5mbigpLFxyXG4gIGRpc2FibGVWZXJ0ZXhBdHRyaWJBcnJheTogamVzdC5mbigpLFxyXG4gIFxyXG4gIC8vIERyYXdpbmdcclxuICBkcmF3QXJyYXlzOiBqZXN0LmZuKCksXHJcbiAgZHJhd0VsZW1lbnRzOiBqZXN0LmZuKCksXHJcbiAgXHJcbiAgLy8gU2hhZGVycyAoZm9yIGZ1dHVyZSB0ZXN0cylcclxuICBjcmVhdGVTaGFkZXI6IGplc3QuZm4oKCkgPT4gKHsgaWQ6IE1hdGgucmFuZG9tKCkgfSkpLFxyXG4gIGNyZWF0ZVByb2dyYW06IGplc3QuZm4oKCkgPT4gKHsgaWQ6IE1hdGgucmFuZG9tKCkgfSkpLFxyXG4gIGNvbXBpbGVTaGFkZXI6IGplc3QuZm4oKSxcclxuICBsaW5rUHJvZ3JhbTogamVzdC5mbigpLFxyXG4gIHVzZVByb2dyYW06IGplc3QuZm4oKSxcclxuICBcclxuICAvLyBTdGF0ZVxyXG4gIHZpZXdwb3J0OiBqZXN0LmZuKCksXHJcbiAgY2xlYXI6IGplc3QuZm4oKSxcclxuICBjbGVhckNvbG9yOiBqZXN0LmZuKCksXHJcbiAgZW5hYmxlOiBqZXN0LmZuKCksXHJcbiAgZGlzYWJsZTogamVzdC5mbigpLFxyXG4gIFxyXG4gIC8vIEVycm9yIGNoZWNraW5nXHJcbiAgZ2V0RXJyb3I6IGplc3QuZm4oKCkgPT4gMCksIC8vIEdMX05PX0VSUk9SXHJcbiAgXHJcbiAgLy8gRXh0ZW5zaW9uc1xyXG4gIGdldEV4dGVuc2lvbjogamVzdC5mbigpLFxyXG4gIGdldFN1cHBvcnRlZEV4dGVuc2lvbnM6IGplc3QuZm4oKCkgPT4gW10pXHJcbn0pO1xyXG5cclxuLy8gTW9jayBjYW52YXMgYW5kIFdlYkdMXHJcbihIVE1MQ2FudmFzRWxlbWVudC5wcm90b3R5cGUuZ2V0Q29udGV4dCBhcyBqZXN0Lk1vY2spID0gamVzdC5mbigoY29udGV4dFR5cGUpID0+IHtcclxuICBpZiAoY29udGV4dFR5cGUgPT09ICd3ZWJnbCcgfHwgY29udGV4dFR5cGUgPT09ICdleHBlcmltZW50YWwtd2ViZ2wnKSB7XHJcbiAgICByZXR1cm4gY3JlYXRlTW9ja1dlYkdMQ29udGV4dCgpIGFzIHVua25vd24gYXMgV2ViR0xSZW5kZXJpbmdDb250ZXh0O1xyXG4gIH1cclxuICBpZiAoY29udGV4dFR5cGUgPT09ICd3ZWJnbDInKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAuLi5jcmVhdGVNb2NrV2ViR0xDb250ZXh0KCksXHJcbiAgICAgIGNyZWF0ZVZlcnRleEFycmF5OiBqZXN0LmZuKCgpID0+ICh7IGlkOiBNYXRoLnJhbmRvbSgpIH0pKSxcclxuICAgICAgZGVsZXRlVmVydGV4QXJyYXk6IGplc3QuZm4oKSxcclxuICAgICAgYmluZFZlcnRleEFycmF5OiBqZXN0LmZuKClcclxuICAgIH0gYXMgdW5rbm93biBhcyBXZWJHTDJSZW5kZXJpbmdDb250ZXh0O1xyXG4gIH1cclxuICByZXR1cm4gbnVsbDtcclxufSk7XHJcblxyXG4vLyBNb2NrIENocm9tZSBBUElzIGZvciBleHRlbnNpb24gdGVzdGluZ1xyXG4oZ2xvYmFsIGFzIGFueSkuY2hyb21lID0ge1xyXG4gIHJ1bnRpbWU6IHtcclxuICAgIG9uTWVzc2FnZToge1xyXG4gICAgICBhZGRMaXN0ZW5lcjogamVzdC5mbigpLFxyXG4gICAgICByZW1vdmVMaXN0ZW5lcjogamVzdC5mbigpXHJcbiAgICB9IGFzIFBhcnRpYWw8Y2hyb21lLmV2ZW50cy5FdmVudDxhbnk+PixcclxuICAgIHNlbmRNZXNzYWdlOiBqZXN0LmZuKCksXHJcbiAgICBnZXRVUkw6IGplc3QuZm4oKHBhdGg6IHN0cmluZykgPT4gYGNocm9tZS1leHRlbnNpb246Ly9tb2NrLWlkLyR7cGF0aH1gKVxyXG4gIH0gYXMgUGFydGlhbDx0eXBlb2YgY2hyb21lLnJ1bnRpbWU+LFxyXG4gIHRhYnM6IHtcclxuICAgIHF1ZXJ5OiBqZXN0LmZuKCksXHJcbiAgICBjcmVhdGU6IGplc3QuZm4oKSxcclxuICAgIHVwZGF0ZTogamVzdC5mbigpXHJcbiAgfSBhcyBQYXJ0aWFsPHR5cGVvZiBjaHJvbWUudGFicz4sXHJcbiAgc3RvcmFnZToge1xyXG4gICAgbG9jYWw6IHtcclxuICAgICAgZ2V0OiBqZXN0LmZuKCksXHJcbiAgICAgIHNldDogamVzdC5mbigpLFxyXG4gICAgICByZW1vdmU6IGplc3QuZm4oKSxcclxuICAgICAgY2xlYXI6IGplc3QuZm4oKVxyXG4gICAgfSBhcyBQYXJ0aWFsPGNocm9tZS5zdG9yYWdlLkxvY2FsU3RvcmFnZUFyZWE+LFxyXG4gICAgc3luYzoge1xyXG4gICAgICBnZXQ6IGplc3QuZm4oKSxcclxuICAgICAgc2V0OiBqZXN0LmZuKCksXHJcbiAgICAgIHJlbW92ZTogamVzdC5mbigpLFxyXG4gICAgICBjbGVhcjogamVzdC5mbigpXHJcbiAgICB9IGFzIFBhcnRpYWw8Y2hyb21lLnN0b3JhZ2UuU3luY1N0b3JhZ2VBcmVhPlxyXG4gIH0gYXMgUGFydGlhbDx0eXBlb2YgY2hyb21lLnN0b3JhZ2U+XHJcbn07XHJcblxyXG4vLyBDb25zb2xlIG92ZXJyaWRlIGZvciB0ZXN0IGNsZWFudXBcclxuY29uc3Qgb3JpZ2luYWxDb25zb2xlID0gZ2xvYmFsLmNvbnNvbGU7XHJcbmdsb2JhbC5jb25zb2xlID0ge1xyXG4gIC4uLm9yaWdpbmFsQ29uc29sZSxcclxuICAvLyBTdXBwcmVzcyBjb25zb2xlLmxvZyBpbiB0ZXN0cyB1bmxlc3MgZXhwbGljaXRseSBuZWVkZWRcclxuICBsb2c6IHByb2Nlc3MuZW52LkpFU1RfVkVSQk9TRSA9PT0gJ3RydWUnID8gb3JpZ2luYWxDb25zb2xlLmxvZyA6IGplc3QuZm4oKSxcclxuICBpbmZvOiBwcm9jZXNzLmVudi5KRVNUX1ZFUkJPU0UgPT09ICd0cnVlJyA/IG9yaWdpbmFsQ29uc29sZS5pbmZvIDogamVzdC5mbigpLFxyXG4gIHdhcm46IG9yaWdpbmFsQ29uc29sZS53YXJuLFxyXG4gIGVycm9yOiBvcmlnaW5hbENvbnNvbGUuZXJyb3IsXHJcbiAgZGVidWc6IHByb2Nlc3MuZW52LkpFU1RfVkVSQk9TRSA9PT0gJ3RydWUnID8gb3JpZ2luYWxDb25zb2xlLmRlYnVnIDogamVzdC5mbigpXHJcbn07XHJcblxyXG4vLyBJbmNyZWFzZSB0aW1lb3V0IGZvciBpbnRlZ3JhdGlvbiB0ZXN0c1xyXG5qZXN0LnNldFRpbWVvdXQoMTAwMDApO1xyXG5cclxuLy8gR2xvYmFsIHRlc3QgdXRpbGl0aWVzXHJcbmdsb2JhbC50ZXN0VXRpbHMgPSB7XHJcbiAgLy8gSGVscGVyIHRvIHdhaXQgZm9yIGFzeW5jIG9wZXJhdGlvbnNcclxuICB3YWl0Rm9yOiAobXM6IG51bWJlcikgPT4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSksXHJcbiAgXHJcbiAgLy8gSGVscGVyIHRvIGNyZWF0ZSBtb2NrIEROQSBzZXF1ZW5jZXNcclxuICBjcmVhdGVNb2NrRE5BOiAobGVuZ3RoOiBudW1iZXIgPSAxNikgPT4ge1xyXG4gICAgY29uc3QgYmFzZXMgPSBbJ0EnLCAnVCcsICdDJywgJ0cnXTtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHsgbGVuZ3RoIH0sICgpID0+IGJhc2VzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGJhc2VzLmxlbmd0aCldKS5qb2luKCcnKTtcclxuICB9LFxyXG4gIFxyXG4gIC8vIEhlbHBlciB0byBjcmVhdGUgdmFsaWQgb3JnYW5pc20gdHJhaXRzXHJcbiAgY3JlYXRlTW9ja1RyYWl0czogKCkgPT4gKHtcclxuICAgIGN1cmlvc2l0eTogTWF0aC5yYW5kb20oKSxcclxuICAgIGZvY3VzOiBNYXRoLnJhbmRvbSgpLFxyXG4gICAgcmh5dGhtOiBNYXRoLnJhbmRvbSgpLFxyXG4gICAgZW1wYXRoeTogTWF0aC5yYW5kb20oKSxcclxuICAgIGNyZWF0aXZpdHk6IE1hdGgucmFuZG9tKCksXHJcbiAgICBlbmVyZ3k6IE1hdGgucmFuZG9tKCksXHJcbiAgICBoYXJtb255OiBNYXRoLnJhbmRvbSgpLFxyXG4gICAgd2lzZG9tOiBNYXRoLnJhbmRvbSgpICogMC4yIC8vIFdpc2RvbSBpcyB0eXBpY2FsbHkgbG93ZXJcclxuICB9KSxcclxuICBcclxuICAvLyBIZWxwZXIgdG8gc3VwcHJlc3MgY29uc29sZSBvdXRwdXQgZHVyaW5nIHRlc3RzXHJcbiAgc3VwcHJlc3NDb25zb2xlOiAoKSA9PiB7XHJcbiAgICBjb25zdCBzcHkgPSB7XHJcbiAgICAgIGxvZzogamVzdC5zcHlPbihjb25zb2xlLCAnbG9nJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KSxcclxuICAgICAgaW5mbzogamVzdC5zcHlPbihjb25zb2xlLCAnaW5mbycpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSksXHJcbiAgICAgIHdhcm46IGplc3Quc3B5T24oY29uc29sZSwgJ3dhcm4nKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pLFxyXG4gICAgICBlcnJvcjogamVzdC5zcHlPbihjb25zb2xlLCAnZXJyb3InKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pLFxyXG4gICAgICBkZWJ1ZzogamVzdC5zcHlPbihjb25zb2xlLCAnZGVidWcnKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICBPYmplY3QudmFsdWVzKHNweSkuZm9yRWFjaChzID0+IHMubW9ja1Jlc3RvcmUoKSk7XHJcbiAgICB9O1xyXG4gIH1cclxufTtcclxuXHJcbi8vIENsZWFuIHVwIGFmdGVyIGVhY2ggdGVzdFxyXG5hZnRlckVhY2goKCkgPT4ge1xyXG4gIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gIGplc3QuY2xlYXJBbGxUaW1lcnMoKTtcclxuICBcclxuICAvLyBSZXNldCBwZXJmb3JtYW5jZSBtb2NrIGlmIGl0IGV4aXN0cyBhbmQgaXMgYSBKZXN0IG1vY2tcclxuICBpZiAoZ2xvYmFsLnBlcmZvcm1hbmNlLm5vdyAmJiB0eXBlb2YgKGdsb2JhbC5wZXJmb3JtYW5jZS5ub3cgYXMgYW55KS5tb2NrQ2xlYXIgPT09ICdmdW5jdGlvbicpIHtcclxuICAgIChnbG9iYWwucGVyZm9ybWFuY2Uubm93IGFzIGplc3QuTW9jaykubW9ja0NsZWFyKCk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFJlc2V0IFJBRiBtb2NrcyBpZiB0aGV5IGV4aXN0IGFuZCBhcmUgSmVzdCBtb2Nrc1xyXG4gIGlmIChnbG9iYWwucmVxdWVzdEFuaW1hdGlvbkZyYW1lICYmIHR5cGVvZiAoZ2xvYmFsLnJlcXVlc3RBbmltYXRpb25GcmFtZSBhcyBhbnkpLm1vY2tDbGVhciA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgKGdsb2JhbC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgYXMgamVzdC5Nb2NrKS5tb2NrQ2xlYXIoKTtcclxuICB9XHJcbiAgaWYgKGdsb2JhbC5jYW5jZWxBbmltYXRpb25GcmFtZSAmJiB0eXBlb2YgKGdsb2JhbC5jYW5jZWxBbmltYXRpb25GcmFtZSBhcyBhbnkpLm1vY2tDbGVhciA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgKGdsb2JhbC5jYW5jZWxBbmltYXRpb25GcmFtZSBhcyBqZXN0Lk1vY2spLm1vY2tDbGVhcigpO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBUeXBlU2NyaXB0IGRlY2xhcmF0aW9ucyBmb3IgZ2xvYmFsIHRlc3QgdXRpbGl0aWVzXHJcbmRlY2xhcmUgZ2xvYmFsIHtcclxuICB2YXIgdGVzdFV0aWxzOiB7XHJcbiAgICB3YWl0Rm9yOiAobXM6IG51bWJlcikgPT4gUHJvbWlzZTx2b2lkPjtcclxuICAgIGNyZWF0ZU1vY2tETkE6IChsZW5ndGg/OiBudW1iZXIpID0+IHN0cmluZztcclxuICAgIGNyZWF0ZU1vY2tUcmFpdHM6ICgpID0+IGFueTtcclxuICAgIHN1cHByZXNzQ29uc29sZTogKCkgPT4gKCkgPT4gdm9pZDtcclxuICB9O1xyXG59ICJdLCJ2ZXJzaW9uIjozfQ==