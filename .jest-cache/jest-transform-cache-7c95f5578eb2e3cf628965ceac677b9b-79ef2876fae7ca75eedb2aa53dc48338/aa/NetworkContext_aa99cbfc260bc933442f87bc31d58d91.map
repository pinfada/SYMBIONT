{"version":3,"names":["cov_172q5jwqsb","actualCoverage","s","exports","NetworkProvider","useNetwork","react_1","require","secureLogger_1","API_URL","process","env","NODE_ENV","b","WS_URL","NetworkContext","createContext","children","f","network","setNetwork","useState","nodes","links","loading","setLoading","error","setError","wsConnected","setWsConnected","actionStatus","setActionStatus","useEffect","fetch","then","res","json","data","catch","ws","WebSocket","onopen","onmessage","event","JSON","parse","logger","onclose","close","invite","source","target","traits","method","headers","body","stringify","setTimeout","fusion","type","participants","result","jsx_runtime_1","jsx","Provider","value","useContext"],"sources":["/mnt/c/Users/m_oli/Projets/SYMBIONT/src/shared/NetworkContext.tsx"],"sourcesContent":["import { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { logger } from '@shared/utils/secureLogger';\r\n\r\nconst API_URL = process.env.NODE_ENV === 'development' ? 'http://localhost:8080' : 'https://symbiont-backend.onrender.com';\r\nconst WS_URL = process.env.NODE_ENV === 'development' ? 'ws://localhost:8080' : 'wss://symbiont-backend.onrender.com';\r\n\r\ninterface Network {\r\n  nodes: any[];\r\n  links: any[];\r\n}\r\ninterface InviteParams {\r\n  source: string;\r\n  target: string;\r\n  traits: any;\r\n}\r\ninterface FusionParams {\r\n  type: string;\r\n  participants: string[];\r\n  result: string;\r\n  traits: any;\r\n}\r\n\r\ninterface NetworkContextType {\r\n  network: Network;\r\n  loading: boolean;\r\n  error: string | null;\r\n  wsConnected: boolean;\r\n  actionStatus: 'idle' | 'loading' | 'success' | 'error';\r\n  invite: (params: InviteParams) => Promise<void>;\r\n  fusion: (params: FusionParams) => Promise<void>;\r\n}\r\n\r\nconst NetworkContext = createContext<NetworkContextType | null>(null);\r\n\r\nexport function NetworkProvider({ children }: { children: ReactNode }) {\r\n  const [network, setNetwork] = useState<Network>({ nodes: [], links: [] });\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [wsConnected, setWsConnected] = useState(false);\r\n  const [actionStatus, setActionStatus] = useState<'idle'|'loading'|'success'|'error'>('idle');\r\n\r\n  // Fetch initial\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    fetch(API_URL + '/api/network')\r\n      .then(res => res.json())\r\n      .then(data => { setNetwork(data); setLoading(false); })\r\n      .catch(() => { setError('Erreur rÃ©seau'); setLoading(false); });\r\n  }, []);\r\n\r\n  // WebSocket\r\n  useEffect(() => {\r\n    const ws = new WebSocket(WS_URL);\r\n    \r\n    ws.onopen = () => {\r\n      setWsConnected(true);\r\n    };\r\n    \r\n    ws.onmessage = (event) => {\r\n      try {\r\n        const data = JSON.parse(event.data);\r\n        setNetwork(data);\r\n      } catch (error) {\r\n        logger.error('Failed to parse network data:', error);\r\n      }\r\n    };\r\n    \r\n    ws.onclose = () => {\r\n      setWsConnected(false);\r\n    };\r\n    \r\n    return () => {\r\n      ws.close();\r\n    };\r\n  }, []);\r\n\r\n  // Actions\r\n  async function invite({ source, target, traits }: InviteParams) {\r\n    setActionStatus('loading');\r\n    try {\r\n      await fetch(API_URL + '/api/invite', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ source, target, traits })\r\n      });\r\n      setActionStatus('success');\r\n      setTimeout(() => setActionStatus('idle'), 2000);\r\n    } catch {\r\n      setActionStatus('error');\r\n    }\r\n  }\r\n  async function fusion({ type, participants, result, traits }: FusionParams) {\r\n    setActionStatus('loading');\r\n    try {\r\n      await fetch(API_URL + '/api/ritual', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ type, participants, result, traits })\r\n      });\r\n      setActionStatus('success');\r\n      setTimeout(() => setActionStatus('idle'), 2000);\r\n    } catch {\r\n      setActionStatus('error');\r\n    }\r\n  }\r\n\r\n  return (\r\n    <NetworkContext.Provider value={{\r\n      network, loading, error, wsConnected, actionStatus,\r\n      invite, fusion\r\n    }}>\r\n      {children}\r\n    </NetworkContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useNetwork() {\r\n  return useContext(NetworkContext)!;\r\n} "],"mappings":"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","ignoreList":[]}