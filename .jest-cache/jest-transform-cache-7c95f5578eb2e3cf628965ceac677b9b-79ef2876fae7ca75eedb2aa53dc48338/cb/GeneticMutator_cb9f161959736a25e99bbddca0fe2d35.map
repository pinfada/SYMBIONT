{"version":3,"names":["cov_1i1d7yr2o2","actualCoverage","s","secureRandom_1","require","GeneticMutator","constructor","mutationProbability","b","traitWeights","environmentalPressure","f","calculateMutationProbability","organism","base","traits","curiosity","focus","Math","min","max","generateMutation","trait","trigger","delta","SecureRandom","random","reason","applyMutation","mutation","chars","dna","split","idx","floor","length","String","fromCharCode","join","mutations","push","timestamp","Date","now","exports"],"sources":["/mnt/c/Users/m_oli/Projets/SYMBIONT/src/neural/GeneticMutator.ts"],"sourcesContent":["import { OrganismState, Mutation } from '../shared/types/organism'\r\nimport { SecureRandom } from '../shared/utils/secureRandom';\n\r\nexport class GeneticMutator {\r\n  private mutationProbability: number;\r\n  // @ts-expect-error Poids réservés pour usage futur\r\n  private traitWeights: Record<string, number>;\r\n  private environmentalPressure: number;\r\n\r\n  constructor(mutationProbability = 0.05, traitWeights: Record<string, number> = {}, environmentalPressure = 1) {\r\n    this.mutationProbability = mutationProbability;\r\n    this.traitWeights = traitWeights;\r\n    this.environmentalPressure = environmentalPressure;\r\n  }\r\n\r\n  // Calcule la probabilité de mutation (peut être enrichi)\r\n  calculateMutationProbability(organism: OrganismState): number {\r\n    let base = this.mutationProbability * this.environmentalPressure;\r\n    // Influence des traits (ex : curiosité favorise la mutation)\r\n    if (organism.traits.curiosity > 0.7) base *= 1.2;\r\n    if (organism.traits.focus < 0.3) base *= 0.8;\r\n    return Math.min(1, Math.max(0, base));\r\n  }\r\n\r\n  // Génère une mutation sur un trait ou le DNA\r\n  generateMutation(trait: string, trigger?: any): Mutation {\r\n    const delta = (SecureRandom.random() - 0.5) * 0.2; // variation [-0.1, +0.1]\r\n    return { trait, delta, reason: trigger || 'genetic' };\r\n  }\r\n\r\n  // Applique la mutation à l'organisme et historise\r\n  applyMutation(organism: OrganismState, mutation: Mutation): OrganismState {\r\n    if (mutation.trait === 'dna') {\r\n      // Mutation du DNA (remplacement aléatoire d'un caractère)\r\n      const chars = organism.dna.split('');\r\n      const idx = Math.floor(SecureRandom.random() * chars.length);\r\n      chars[idx] = String.fromCharCode(33 + Math.floor(SecureRandom.random() * 94));\r\n      organism.dna = chars.join('');\r\n    } else {\r\n      // Mutation d'un trait\r\n      organism.traits[mutation.trait] = Math.max(0, Math.min(1, (organism.traits[mutation.trait] ?? 0.5) + mutation.delta));\r\n    }\r\n    organism.mutations = organism.mutations || [];\r\n    organism.mutations.push({ ...mutation, timestamp: Date.now() });\r\n    return organism;\r\n  }\r\n} "],"mappings":"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","ignoreList":[]}