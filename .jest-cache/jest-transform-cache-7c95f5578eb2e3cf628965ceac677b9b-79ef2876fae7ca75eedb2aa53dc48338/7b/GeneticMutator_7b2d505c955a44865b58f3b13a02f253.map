{"version":3,"names":["cov_1i1d7yr2o2","actualCoverage","s","GeneticMutator","constructor","mutationProbability","b","traitWeights","environmentalPressure","f","calculateMutationProbability","organism","base","traits","curiosity","focus","Math","min","max","generateMutation","trait","trigger","delta","random","reason","applyMutation","mutation","chars","dna","split","idx","floor","length","String","fromCharCode","join","mutations","push","timestamp","Date","now","exports"],"sources":["/mnt/c/Users/m_oli/Projets/SYMBIONT/src/neural/GeneticMutator.ts"],"sourcesContent":["import { OrganismState, Mutation } from '../shared/types/organism'\r\n\r\nexport class GeneticMutator {\r\n  private mutationProbability: number;\r\n  // @ts-expect-error Poids réservés pour usage futur\r\n  private traitWeights: Record<string, number>;\r\n  private environmentalPressure: number;\r\n\r\n  constructor(mutationProbability = 0.05, traitWeights: Record<string, number> = {}, environmentalPressure = 1) {\r\n    this.mutationProbability = mutationProbability;\r\n    this.traitWeights = traitWeights;\r\n    this.environmentalPressure = environmentalPressure;\r\n  }\r\n\r\n  // Calcule la probabilité de mutation (peut être enrichi)\r\n  calculateMutationProbability(organism: OrganismState): number {\r\n    let base = this.mutationProbability * this.environmentalPressure;\r\n    // Influence des traits (ex : curiosité favorise la mutation)\r\n    if (organism.traits.curiosity > 0.7) base *= 1.2;\r\n    if (organism.traits.focus < 0.3) base *= 0.8;\r\n    return Math.min(1, Math.max(0, base));\r\n  }\r\n\r\n  // Génère une mutation sur un trait ou le DNA\r\n  generateMutation(trait: string, trigger?: any): Mutation {\r\n    const delta = (Math.random() - 0.5) * 0.2; // variation [-0.1, +0.1]\r\n    return { trait, delta, reason: trigger || 'genetic' };\r\n  }\r\n\r\n  // Applique la mutation à l'organisme et historise\r\n  applyMutation(organism: OrganismState, mutation: Mutation): OrganismState {\r\n    if (mutation.trait === 'dna') {\r\n      // Mutation du DNA (remplacement aléatoire d'un caractère)\r\n      const chars = organism.dna.split('');\r\n      const idx = Math.floor(Math.random() * chars.length);\r\n      chars[idx] = String.fromCharCode(33 + Math.floor(Math.random() * 94));\r\n      organism.dna = chars.join('');\r\n    } else {\r\n      // Mutation d'un trait\r\n      organism.traits[mutation.trait] = Math.max(0, Math.min(1, (organism.traits[mutation.trait] ?? 0.5) + mutation.delta));\r\n    }\r\n    organism.mutations = organism.mutations || [];\r\n    organism.mutations.push({ ...mutation, timestamp: Date.now() });\r\n    return organism;\r\n  }\r\n} "],"mappings":"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","ignoreList":[]}